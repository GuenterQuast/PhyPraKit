
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PhyPraKit Documentation &#8212; PhyPraKit 1.2.3b1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">PhyPraKit 1.2.3b1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><strong>PhyPraKit Documentation</strong></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="phyprakit-documentation">
<h1><strong>PhyPraKit Documentation</strong><a class="headerlink" href="#phyprakit-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Version 1.2.3b1, Date 2022-06-30</p>
</div></blockquote>
<p><strong>PhyPraKit</strong> is a collection of python modules
for data visualization and analysis in experimental laboratory
courses in physics and is in use in the Department of Physics
at Karlsruhe Institute of Technology (KIT).
As the modules are intended primarily for use by undergraduate
students in Germany, the documentation is partly in German language,
in particular the description of the examples.</p>
<p>Created by:</p>
<ul class="simple">
<li><p>Guenter Quast &lt;guenter (dot) quast (at) online (dot) de&gt;</p></li>
</ul>
<p>A pdf version of this documentation is available here: <a class="reference external" href="PhyPraKit.pdf">PhyPraKit.pdf</a>.</p>
<div class="section" id="installation">
<h3>Installation:<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>To use PhyPraKit, it is sufficient to place the directory
<cite>PhyPraKit</cite> and all the files in it in the same directory as the
python scripts importing it.</p>
<p>Installation via <cite>pip</cite> is also supported.
After downloading, execute:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">.</span></code></p>
<p>in the main directory of the <em>PhyPraKit</em> package (where <em>setup.py</em>
is located) to install in user space.</p>
<p>Comfortable installation via the PyPI Python Package Index
is also possible by executing</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">PhyPraKit</span></code></p>
</div></blockquote>
<p>The installation via the <em>whl</em>-package provided
in the subdirectory <cite>dist</cite> may alternatively be used:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">--no-cache</span> <span class="pre">PhyPraKit&lt;version&gt;.whl</span></code></p>
</div></blockquote>
<p><em>python</em> scripts and <em>Jupyter</em> notebook versions illustrate common
use cases of the package and provide examples of typical applications.</p>
<p><strong>German Description:</strong></p>
<p><strong>PhyPraKit</strong> ist eine Sammlung nützlicher Funktionen in der Sprache
<cite>Python (&gt;=3.6, die meisten Module laufen auch noch mit der inzwischen
veralteten Verson 2.7)</cite> zum Aufnehmen, zur Bearbeitung,
Visualisierung und Auswertung von Daten in Praktika zur Physik.
Die Anwendung der verschiedenen Funktionen des Pakets
werden jeweils durch Beispiele illustriert.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
<div class="section" id="visualization-and-analysis-of-measurement-data">
<h2><strong>Visualization and Analysis of Measurement Data</strong><a class="headerlink" href="#visualization-and-analysis-of-measurement-data" title="Permalink to this headline">¶</a></h2>
<p>Methods for recording, processing, visualization and analysis of
measurement data are required in all laboratory courses in Physics.</p>
<p>This collection of tools in the package <cite>PhyPraKit</cite> contains
functions for reading data from various sources, for data
visualization, signal processing and statistical data analysis and
model fitting as well as tools for the generation of simulated data.
Emphasis was put on simple implementations, illustrating the
principles of the underlying algorithms.</p>
<p>The class <em>mnFit</em> in the module <em>phyFit</em> offers a light-weight
implementation for fitting model functions to data with uncorrelated
and/or correlated absolute and/or relative uncertainties in ordinate
and/or abscissa directions. Support for likelihood fits to binned
data (histograms) and to unbinned data is also provided.</p>
<p>For complex kinds of uncertainties, there are hardly any are easy-to-use
program packages. Most of the existing applications use presets aiming
at providing a parametrization of measurement data, whereby the validity
of the parametrization is assumed and the the parameter uncertainties are
scaled so that the data is well described. In physics applications, on the
contrary, testing the validity of model hypothesis is of central importance
before extracting any model parameters. Therefore, uncertainties must be
understood, modeled correctly and incorporated in the fitting procedure.</p>
<p><em>PhyPraKit</em> offers adapted interfaces to the fit modules in the package
<em>scipy</em> (<em>optimize.curve_fit</em> and <em>ODR</em>) to perform fits including a test
of the validity of the model hypothesis. A very lean implementation, relying
on the mimimization and uncertainty-analysis tool <em>MINUIT</em>, is also provided
in the sub-package <em>phyFit</em> for the above-mentioned use cases.
<em>PhyPraKit</em> also contains a simplified interface to the very
function-rich fitting package <em>kafe2</em>.</p>
<blockquote>
<div><p><strong>German: Darstellung und Auswertung von Messdaten</strong></p>
</div></blockquote>
<p>In allen Praktika zur Physik werden Methoden zur Aufnahme,
Bearbeitung, Darstellung und Auswertung von Messdaten benötigt.</p>
<p>Die vorliegende Sammlung im Paket <cite>PhyPraKit</cite> enthält
Funktionen zum Einlesen von Daten aus diversen Quellen,
zur Signalbearbeitung und Datenvisualisierung und zur
statistischen Datenauswertung und Modellanpassung sowie
Werkzeuge zur Erzeugung simulierter Pseudo-Daten.
Dabei wurde absichtlich Wert auf eine einfache, die Prinzipien
unterstreichende Codierung gelegt und nicht der möglichst effizienten
bzw. allgemeinsten Implementierung der Vorzug gegeben.</p>
<p>Das Modul <em>phyFit</em> bietet mit der Klasse <em>mnFit</em> eine schlanke
Implementierung zur Anpassung von Modellfunktionen an Daten,
die mit unkorrelierten und/oder korrelierten absoluten
und/oder relativen Unsicherheiten in Ordinaten- und/oder
Abszissenrichtung behaftet sind. Anpassungen an gebinnte Daten
(Histogramme) und Maxium-Likelihood-Anassungen zur Bestimmung der
Parameter der Verteilung von Daten werden ebenfalls unterstützt.
Für solche in der Physik häufig auftretenden komplexen Formen von
Unsicherheiten gibt es kaum andere, einfach zu verwendende
Programmpakete. Viele Pakte sind als Voreinstellung auf
die Parametrisierung von Messdaten ausgelegt, wobei die
Parameterunsicherheiten unter Annahme der Gültigkeit der
Parametrisierung so skaliert werden, dass die Daten gut
repräsentiert werden. Um den besonderen Anforderungen in
der Physik Rechnung zu tragen, bietet <em>PhyPraKit</em> deshalb
entsprechend  angepasste Interfaces zu den Fitmodulen im
Paket <em>scipy</em> (<em>optimize.curve_fit</em> und <em>ODR</em>), um Anpassungen
mit Test der  Gültigkeit der Modellhypothese durchzuführen.
<em>PhyPraKit</em> enthält ebenfalls ein vereinfachtes Interface zum sehr
funktionsreichen Anpassungspaket <em>kafe2</em>.</p>
<p>In der Vorlesung “Computergestützte Datenauswertung” an der Fakultät
für Physik am Karlsruher Institut für Physik
(<a class="reference external" href="http://www.etp.kit.edu/~quast/CgDA">http://www.etp.kit.edu/~quast/CgDA</a>)
werden die in <em>PhyPraKit</em> verwendeten Methoden eingeführt und
beschrieben.
Hinweise zur Installation der empfohlenen Software finden sich
unter den Links
<a class="reference external" href="http://www.etp.kit.edu/~quast/CgDA/CgDA-SoftwareInstallation-html">http://www.etp.kit.edu/~quast/CgDA/CgDA-SoftwareInstallation-html</a> und
<a class="reference external" href="http://www.etp.kit.edu/~quast/CgDA/CgDA-SoftwareInstallation.pdf">http://www.etp.kit.edu/~quast/CgDA/CgDA-SoftwareInstallation.pdf</a> .</p>
<p>Speziell für das “Praktikum zur klassischen Physik” am KIT gibt es
eine  kurze Einführung in die statistischen Methoden und Werkzeuge
unter dem Link
<a class="reference external" href="http://www.etp.kit.edu/~quast/CgDA/PhysPrakt/CgDA_APraktikum.pdf">http://www.etp.kit.edu/~quast/CgDA/PhysPrakt/CgDA_APraktikum.pdf</a> .</p>
<p>Über den Link
<a class="reference external" href="http://www.etp.kit.edu/~quast/jupyter/jupyterTutorial.html">http://www.etp.kit.edu/~quast/jupyter/jupyterTutorial.html</a>
werden eine Einführung in die Verwendung von Jupyter Notebooks
sowie Tutorials für verschiedene Aspekte der statistischen
Datenauswertung mit Beispielen zum Einsatz von Modulen aus
<em>PhyPraKit</em> bereit gestellt.</p>
</div>
<div class="section" id="dokumentation-der-module-und-beispiele">
<h2>Dokumentation der Module und Beispiele<a class="headerlink" href="#dokumentation-der-module-und-beispiele" title="Permalink to this headline">¶</a></h2>
<p><strong>`PhyPraKit.py`</strong> ist ein Paket mit nützlichen Hilfsfunktionen
zum import in eigene Beispiele mittels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PhyPraKit</span> <span class="k">as</span> <span class="nn">ppk</span>
</pre></div>
</div>
<p>oder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PhyPraKit</span> <span class="kn">import</span> <span class="o">...</span>
</pre></div>
</div>
<p><strong>PhyPraKit</strong> enthält folgende <strong>Funktionen</strong>:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Daten-Ein und -Ausgabe</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>readColumnData() Daten und Meta-Daten aus Textdatei lesen</p></li>
<li><p>readCSV()        Daten im csv-Format aus Datei mit Header lesen</p></li>
<li><p>readtxt()        Daten im Text-Format aus Datei mit Header lesen</p></li>
<li><p>readPicoScope()  mit PicoScope exportierte Daten einlesen</p></li>
<li><p>readCassy()      mit CASSY im .txt-Format exportierte Dateien einlesen</p></li>
<li><p>labxParser()     mit CASSY im .labx-Format exportierte Dateien einlesen</p></li>
<li><p>writeCSV()       Daten csv-Format schreiben (optional mit Header)</p></li>
<li><p>writeTexTable()  Daten als LaTeX-Tabelle exportieren</p></li>
<li><p>round_to_error() Runden von Daten mit Präzision wie Unsicherheit</p></li>
<li><p>ustring()        korrekt gerundete Werte v +/- u als Text;
alternativ: der Datentyp <em>ufloat(v, u)</em> im Paket <em>uncertainties</em>
unterstützt die korrekte Ausgabe von Werten <em>v</em> mit Unsicherheiten <em>u</em>.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Signalprozessierung:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>offsetFilter()      Abziehen eines off-sets</p></li>
<li><p>meanFilter()        gleitender Mittelwert zur Glättung</p></li>
<li><p>resample()          Mitteln über n Datenwerte</p></li>
<li><p>simplePeakfinder()  Auffinden von Maxima (Peaks) und Minima
(<cite>Empfehlung: convolutionPeakfinder nutzen</cite>)</p></li>
<li><p>convolutionPeakfinder() Finden von  Maxima</p></li>
<li><p>convolutionEdgefinder() Finden von Kanten</p></li>
<li><p>Fourier_fft()       schnelle Fourier-Transformation (FFT)</p></li>
<li><p>FourierSpectrum()   Fourier-Transformation
<cite>(langsam, vorzugsweise FFT-Version nutzen)</cite></p></li>
<li><p>autocorrelate()     Autokorrelation eines Signals</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Statistik:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>wmean()                  Berechnen des gewichteten Mittelwerts</p></li>
<li><p>BuildCovarianceMatrix()  Kovarianzmatrix aus Einzelunsicherheiten</p></li>
<li><p>Cov2Cor()                Konversion Kovarianzmatrix -&gt; Korrelationsmatrix</p></li>
<li><p>Cor2Cov()                Konversion Korrelationsmatrix +
Unsicherheiten -&gt; Kovarianzmatrix</p></li>
<li><p>chi2prob()               Berechnung der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Wahrscheinlichkeit</p></li>
<li><p>propagatedError()        Numerische Fehlerfortpflanzung;
Hinweis: der Datentyp <em>ufloat(v, u)</em> im Paket <em>uncertainties</em>
unterstützt Funktionen von Werten <em>v</em> mit Unsicherheiten <em>u</em> und
die korrekte Fehlerfortpflanzung</p></li>
<li><p>getModelError()          Numerische Fehlfortpflanzung für
parameterabhängige Funktionswerte</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Histogramme:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>barstat()   statistisch Information aus Histogramm (Mittelwert,
Standardabweichung, Unsicherheit des Mittelwerts)</p></li>
<li><p>nhist()    Histogramm-Grafik mit np.historgram() und plt.bar()
<cite>(besser matplotlib.pyplot.hist() nutzen)</cite></p></li>
<li><p>histstat() statistische Information aus 1d-Histogram</p></li>
<li><p>nhist2d()  2d-Histogramm mit np.histrogram2d, plt.colormesh()
<cite>(besser matplotlib.pyplot.hist2d() nutzen)</cite></p></li>
<li><p>hist2dstat() statistische Information aus 2d-histogram</p></li>
<li><p>profile2d()  “profile plot” für 2d-Streudiagramm</p></li>
<li><p>chi2p_indep2d() <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test auf Unabhängigkeit von zwei Variablen</p></li>
<li><p>plotCorrelations() Darstellung von Histogrammen und Streudiagrammen
von Variablen bzw. Paaren von Variablen eines multivariaten
Datensatzes</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Lineare Regression und Anpassen von Funktionen:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>linRegression()    lineare Regression, y=ax+b, mit analytische Formel</p></li>
<li><p>odFit()            Funktionsanpassung mit x- und y-Unsicherheiten (scipy ODR)</p></li>
<li><p>xyFit()            Funktionsanpassung an Datenpunkte (x_i, y_i=f(x_i)) mit
(korrelierten) x- und y-Unsicherheiten mit <em>phyFit</em></p></li>
<li><p>hFit()             maximum-likelihood-Anpassung einer
Verteilungsdichte an Histogramm-Daten mit <em>phyFit</em></p></li>
<li><p>mFit()             Anpassung einer Nutzerdefinierten Kostenfunktion oder einer
Verteilungsdichte an ungebinnete Daten mit der maximum-likelood
Methode (mit <em>phyFit</em>)</p></li>
<li><p>xFit()            Anpassung eines Modells an indizierte Daten
x_i=x_i(x_j, *par) mit <em>phyFit</em></p></li>
<li><p>k2Fit()            Funktionsanpassung mit (korrelierten) x- und y-Unsicherheiten
mit dem Paket <em>kafe2</em> an Datenpunkte (x_i , y_i=f(x_i))</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Erzeugung simulierter Daten mit MC-Methode:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>smearData()          Addieren von zufälligen Unsicherheiten auf Eingabedaten</p></li>
<li><p>generateXYdata()     Erzeugen simulierter Datenpunkte (x+Delta_x, y+Delta_y)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Die folgenden <strong>Beispiele</strong> im Unterverzeichnis <cite>PhyPraKit/examples/</cite>
dienen der Illustration der Anwendung der zahlreichen Funktionen.</p>
<p>Eine direkt im Browser ausführbare Installation von <em>PhyPraKit</em> gibt es auf
<a class="reference external" href="https://mybinder.org/v2/git/https%3A%2F%2Fgit.scc.kit.edu%2Fyh5078%2FPhyPraKit/master">mybinder.org</a>.</p>
<p><strong>Beispiele zur Anwendung der Module aus PhyPraKit</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><cite>test_readColumnData.py</cite> ist ein Beispiel zum
Einlesen von Spalten aus Textdateien; die zugehörigen
<em>Metadaten</em> können ebenfalls an das Script übergeben
werden und stehen so bei der Auswertung zur Verfügung.</p></li>
<li><p><cite>test_readtxt.py</cite> liest Ausgabedateien im allgemeinem <cite>.txt</cite>-Format;
ASCII-Sonderzeichen außer dem Spalten-Trenner werden ersetzt,
ebenso wie das deutsche Dezimalkomma durch den Dezimalpunkt</p></li>
<li><p><cite>test_readPicoScope.py</cite> liest Ausgabedateien von USB-Oszillographen
der Marke PicoScope im Format <cite>.csv</cite> oder <cite>.txt</cite>.</p></li>
<li><p><cite>test_labxParser.py</cite> liest Ausgabedateien von Leybold
CASSY im <cite>.labx</cite>-Format. Die Kopfzeilen und Daten von Messreihen
werden als Listen in <em>Python</em> zur Verfügung gestellt.</p></li>
<li><p><cite>test_convolutionFilter.py</cite> liest die Datei <cite>Wellenform.csv</cite> und
bestimmt Maxima und fallende Flanken des Signals.</p></li>
<li><p><cite>test_AutoCorrelation.py</cite> liest die Datei <cite>AudioData.csv</cite> und führt
eine Analyse der Autokorrelation zur Frequenzbestimmung durch.</p></li>
<li><p><cite>test_Fourier.py</cite> illustriert die Durchführung einer
Fourier-Transfomation eines periodischen Signals, das in
der PicoScope-Ausgabedatei <cite>Wellenform.csv</cite> enthalten ist.</p></li>
<li><p><cite>test_propagatedError.py</cite> illustriert die Anwendung von numerisch
berechneter Fehlerfortpflanzung und korrekter Rundung von Größen
mit Unsicherheit</p></li>
<li><p><cite>test_linRegression.py</cite> ist eine einfachere Version mit
<cite>python</cite>-Bordmitteln zur Anpassung einer Geraden an
Messdaten mit Unsicherheiten in Ordinaten- und Abszissenrichtung.
Korrelierte Unsicherheiten werden nicht unterstützt.</p></li>
<li><p><cite>test_xyFit</cite> dient zur Anpassung einer beliebigen Funktion an
Messdaten mit Unsicherheiten in Ordinaten- und Abszissenrichtung
und mit allen Messpunkten gemeinsamen (d. h. korrelierten) relativen
oder absoluten systematischen Fehlern. Dazu wird das Paket <em>imunit</em>
verwendet, das den am CERN entwickelten Minimierer MINUIT nutzt.
Da die Kostenfunktion frei definiert und auch während der Anpassung
dynamisch aktualisiert werden kann, ist die Implementierung von
Parameter-abhängigen Unsicherheiten möglich. Ferner unterstützt
<em>iminuit</em> die Erzeugung und Darstellung von Profil-Likelihood-Kurven
und Konfidenzkonturen, die so mit <cite>xyFit</cite> ebenfalls dargestellt
werden können.</p></li>
<li><p><cite>test_k2Fit.py</cite> verwendet das funktionsreiche Anpassungspaket <em>kafe2</em>
zur Anpassung einer Funktion an Messdaten mit unabhängigen oder
korrelierten relativen oder absoluten Unsicherheiten in Ordinaten-
und Abszissenrichtung.</p></li>
<li><p><cite>test_simplek2Fit.py</cite> illustriert die Durchführung einer einfachen
linearen Regression mit <em>kafe2</em> mit einer minimalen Anzahl eigener
Codezeilen.</p></li>
<li><p><cite>test_k2hFit.py</cite> führt eine Anpassung einer Verteilungsdichte an
Histogrammdaten mit <em>kafe2</em> durch. Die Kostenfunktion ist das
zweifache der negativen log-Likelihood-Funktion der Poisson-Verteilung,
Poiss(k; lam), oder - optional - ihrer Annäherung durch eine
Gauß-Verteilung mit Gauss(x, mu=lam, sig**2=lam). Die Unsicherheiten
werden aus der Modellvorhersage bestimmt, um auch Bins mit wenigen oder
sogar null Einträgen korrekt zu behandeln.</p></li>
<li><p><cite>test_hFit</cite> illustriert die Anpassung einer Verteilungsdichte an
histogrammierte Daten. Die Kostenfunktion für die Minimierung ist das
zweifache der negativen log-Likelihood-Funktion der Poisson-Verteilung,
Poiss(k; lam), oder - optional - ihrer Annäherung durch eine
Gauß-Verteilung mit Gauss(x, mu=lam, sig**2=lam). Die Unsicherheiten
werden aus der Modellvorhersage bestimmt, um auch Bins mit wenigen oder
sogar null Einträgen korrekt zu behandeln. Grundsätzlich wird eine normierte
Verteilungsdichte angepasst; es ist aber optional auch möglich, die
Anzahl der Einträge mit zu berücksichtigen, um so z. B. die
Poisson-Unsicherheit der Gesamtanzahl der Histogrammeinträge zu
berücksichtigen.</p></li>
<li><p><cite>test_mlFit</cite> illustriert die Anpassung einer Verteilungsdichte an
ungebinnte Daten mit der maximum-likelihood Methode. Die Kostenfunktion
für die Minimierung ist der negative natürliche Logarithmus der vom
Nutzer agegebenen Verteilungsdichte (oder, optional, deren Zweifaches).</p></li>
<li><p><cite>test_xFit</cite> ist ein Beispiel für eine Anpassung einer Modellvorhersage
an allgemeine Eingabedaten (“indizierte Daten” <em>x_1, …, x_n</em>). Dabei
sind die x_i Funktionen der Parameter p_i einer Modellvorhersage, und ggf.
auch von Elementen x_j der Eingabedaten: x_i(x_j, *par). In diesem
Beispiel werden zwei Messungen eines Ortes in Polarkoordinaten gemittelt
und in kartesische Koordinaten umgerechnet. Bei dieser nicht-linearen
Transformation weden sowohl die Zentralwerte als auch Konfidenzkonturen
korrekt bestimmt.</p></li>
<li><p><cite>test_Histogram.py</cite> ist ein Beispiel zur Darstellung und
statistischen Auswertung von Häufigkeitsverteilungen (Histogrammen)
in ein oder zwei Dimensionen.</p></li>
<li><p><cite>test_generateXYata.py</cite> zeigt, wie man mit Hilfe von Zufallszahlen
“künstliche Daten” zur Veranschaulichung oder zum Test von Methoden
zur Datenauswertung erzeugen kann.</p></li>
<li><p><cite>toyMC_Fit.py</cite> führt eine große Anzahl Anpassungen an simulierte
Daten durch. Durch Vergleich der wahren Werte mit den aus der
Anpassung bestimmten Schätzwerte und deren Unsicherheiten lassen
sich Verzerrungen der Parameterschätzungen, die korrekte Überdeckung
der in der Anpassung geschätzen Konfidenzbereiche für die Parameter,
Korrelationen der Parameter oder die Form der Verteilung der
<span class="math notranslate nohighlight">\(\chi^2\)</span>-Wahrscheinlichkeit überprüfen, die im Idealfall
eine Rechteckverteilung im Intervall [0,1] sein sollte.</p></li>
</ul>
</div></blockquote>
<p><strong>Komplexere Beispiele für konkrete Anwendungen in Praktika</strong></p>
<blockquote>
<div><p>Die folgenden <em>python</em>-Skripte sind etwas komplexer und illustrieren
typische Anwendungsfälle der Module in <cite>PhyPraKit</cite>:</p>
<ul class="simple">
<li><p><cite>Beispiel_Diodenkennlinie.py</cite> demonstriert die Analyse einer
Strom-Spannungskennlinie am Beispiel von (künstlichen) Daten,
an die die Shockley-Gleichung angepasst wird. Typisch für
solche Messungen über einen weiten Bereich von Stromstärken
ist die Änderung des Messbereichs und damit der Anzeigegenauigkeit
des verwendeten Messgeräts. Im steil ansteigenden Teil der
Strom-Spannungskennlinie dominieren die Unsicherheiten
der auf der x-Achse aufgetragen Spannungsmesswere.
Eine weitere Komponente der Unsicherheit ergibt sich aus der
Kalibrationsgenauigkeit des Messgeräts, die als relative,
korrelierte Unsicherheit aller Messwerte berücksichtigt werden
muss. Das Beispiel zeigt, wie man in diesem Fall die Kovarianzmatrix
aus Einzelunsicherheiten aufbaut. Die Funktionen <em>k2Fit()</em> und
<em>xyfit()</em> bieten dazu komfortable und leicht zu verwendende
Interfaces, deren Anwendung zur Umsetzung des komplexen Fehlermodells
in diesem Beispiel gezeigt wird.</p></li>
<li><p><cite>Beispiel_Drehpendel.py</cite> demonstriert die Analyse von am Drehpendel
mit CASSY aufgenommenen Daten. Enthalten sind einfache Funktionen zum
Filtern und Bearbeiten der Daten, zur Suche nach Extrema und Anpassung
einer Einhüllenden, zur diskreten Fourier-Transformation und zur
Interpolation von Messdaten mit kubischen Spline-Funktionen.</p></li>
<li><p><cite>Beispiel_Hysterese.py</cite> demonstriert die Analyse von Daten,
die mit einem USB-Oszilloskop der Marke <cite>PicoScope</cite> am
Versuch zur Hysterese aufgenommen wurden. Die aufgezeichneten Werte
für Strom und B-Feld werden in einen Zweig für steigenden und
fallenden Strom aufgeteilt, mit Hilfe von kubischen Splines
interpoliert und dann integriert.</p></li>
<li><p><cite>Beispiel_Wellenform.py</cite>  zeigt eine typische Auswertung
periodischer Daten am Beispiel der akustischen Anregung eines
Metallstabs. Genutzt werden Fourier-Transformation und
eine Suche nach charakteristischen Extrema. Die Zeitdifferenzen
zwischen deren Auftreten im Muster werden bestimmt, als
Häufgkeitsverteilung dargestellt und die Verteilungen statistisch
ausgewertet.</p></li>
<li><p><cite>Beispiel_Multifit.py</cite> illustiert die simultane Anpassung von Parametern
an mehrere, gleichartige Messreihen, die mit <em>kafe2</em> möglich ist.
Ein Anwendungsfall sind mehrere Messreihen mit der gleichen Apparatur,
um die Eigenschaften von Materialien in Proben mit unterschiedlicher
Geometrie zu bestimmen, wie z. B. die Elastizität oder den spezifischen
Widerstand an Proben mit unterschiedlichen Querschnitten und Längen.
Auf die Apparatur zurückzuführende Unsicherheiten sind in allen Messreihen
gleich, auch die interessierende Materialeigenschaft ist immer die
gleiche, lediglich die unterschiedlichen Gemoetrie-Parameter und die
jeweils bestimmten Werte der Messreihen haben eigene, unabhängige
Unsicherheiten.</p></li>
<li><p><cite>Beispiel_GeomOptik.py</cite> zeigt, wie man mittels Parametertransformation
die Einzelbrennweiten der beiden Linsen eines Zwei-Linsensystems
aus der Systembrennweite und den Hauptebenenlagen bestimmen kann.
Dabei wird neben der Transformation auf den neuen Parametersatz
auch eine Mittelung über mehrere Messreihen durchgeführt, deren
Ergebnisse ihrerseits aus Anpassungen gewonnen wurden. Die
Paramtertransformation wird als Anpassungsproblem mit einer
<span class="math notranslate nohighlight">\(\chi^2\)</span> Kostenfunktion behandelt und so auch die Konfidenzkonturen
der neuen Parameter bestimmt.</p></li>
<li><p><cite>Beispiel_GammaSpektroskopie.py</cite> liest mit dem Vielkanalanalysator
des CASSY-Systems im <cite>.labx</cite> -Format gespeicherten Dateien ein
(Beispieldatei <cite>GammaSpektra.labx</cite>).</p></li>
</ul>
</div></blockquote>
<p><strong>Stand-alone Tools für Standard-Aufgaben:</strong></p>
<p>Für Standardaufgaben gibt es einige Python-Programme im Verzeichnis
<cite>PhyPraKit/tools/</cite>, die als stand-alone Anwendungen gedacht sind. Die
Programme sind auch Teil des Installationspakets und können von allen
Stellen im Dateisystem aus als Modul aufgerufen werden, wenn <em>PhyPraKit</em>
als <em>Python</em>-Paket installiert ist:</p>
<blockquote>
<div><p><cite>python3 -m PhyPraKit.&lt;ToolName&gt; [Optionen] &lt;Eingabedatei&gt;</cite></p>
</div></blockquote>
<p><strong>Daten darstellen mit dem Skript plotData.py</strong></p>
<blockquote>
<div><p>Mitunter ist eine einfache und unkomplizierte Darstellung von Daten
erwünscht, ohne speziellen <em>Python</em>-Code zu erstellen. Damit das
funktioniert, müssen die Daten in einem Standardformat vorliegen.
Dazu empfiehlt sich die Datenbeschreibungssprache <em>yaml</em>, mit der
auch die notwendigen “Meta-Daten” wie Titel, Art des Datensatzes und
der auf der x- und y-Achse darzustellenden Daten angegeben werden
können. Die Daten und deren Unsicherheiten werden als Liste von durch
Kommata getrennten Dezimalzahlen (mit Dezimalpunkt!) angegeben.</p>
<p>Das Skript <em>plotData.py</em> unterstützt die Darstellun von Datenpunkten
(x,y) mit Unsicherheiten und Histogramme. Die Beispieldateien ‘data.yaml’
und hData.yaml erläutern das unterstützte einfache Datenformat.</p>
<p>Für (x,y)-Daten:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">x1</span><span class="p p-Indicator">,</span> <span class="nv">x2</span><span class="p p-Indicator">,</span> <span class="nv">...</span> <span class="p p-Indicator">,</span> <span class="nv">xn</span><span class="p p-Indicator">]</span>
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">y1</span><span class="p p-Indicator">,</span> <span class="nv">y2</span><span class="p p-Indicator">,</span> <span class="nv">...</span> <span class="p p-Indicator">,</span> <span class="nv">yn</span> <span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-uncertainty or [ex1, ex2, ..., exn]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">y-uncertainty or [ey1, ey2, ..., eyn]</span>

<span class="l l-Scalar l-Scalar-Plain">Bei Eingabe von mehreren Datensätzen werden diese getrennt durch</span>
<span class="nn">...</span>
<span class="nn">---</span>
<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of 2nd data set&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">2nd set of x values</span> <span class="p p-Indicator">]</span>
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">2nd set of y values</span> <span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-uncertainty or [x-uncertainties]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">y-uncertainty or [y-uncertainties]</span>
</pre></div>
</div>
<p>und für Histogrammdaten:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>
<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">raw_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x1</span><span class="p p-Indicator">,</span> <span class="nv">...</span> <span class="p p-Indicator">,</span> <span class="nv">xn</span><span class="p p-Indicator">]</span>
<span class="c1"># define binning</span>
<span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">n</span>
<span class="nt">bin_range</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x_min</span><span class="p p-Indicator">,</span> <span class="nv">x_max</span><span class="p p-Indicator">]</span>
<span class="c1">#   alternatively:</span>
<span class="c1"># bin edges: [e0, ..., en]</span>

<span class="c1"># wie oben ist Eingabe von mehreren Datensätzen möglich, getrennt durch</span>
<span class="nn">...</span>
<span class="nn">---</span>
</pre></div>
</div>
<p>Zur Ausführung dient die Eingabe von</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">plotData.py</span> <span class="pre">[option]</span> <span class="pre">&lt;yaml.datei&gt;</span></code></p>
<p>auf der Kommandozeile.
<code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">plotData.py</span> <span class="pre">-h</span></code> gibt die unterstützen Optionen aus.</p>
<p>Wenn in der <em>yaml</em>-Datei eine Modellfunktion angeben ist,
wird sie in der Grafik ebenfalls angezeigt.
Der <em>yaml</em>-Block dazu sieht folgendermaßen aus:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># optional model specification</span>
<span class="nt">model_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;model name&gt;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;Python code of model function&gt;</span>
</pre></div>
</div>
<p>Es ist auch möglich, nur die Modellfunktion anzuzeigen, wenn keine
Daten (<cite>y_data</cite> oder <cite>raw_data</cite>) angegeben werden. Minimale Daten
zu den <cite>x</cite>-Werten (<cite>x_data</cite> oder <cite>bin_range</cite>) werden aber dennoch
benötigt, um den Wertebereich auf der <em>x</em>-Achse festzulegen.</p>
</div></blockquote>
<p><strong>Einfache Anpassungen mit run_phyFit.py</strong></p>
<blockquote>
<div><p>Die notwendigen Informationen zur Durchführung von Anpassungen
können ebenfalls als Datei angegeben werden, die in der
Datenbeschreibungssprache <em>yaml</em> erstellt wurden.</p>
<p>Zur Ausführung dient die Eingabe von</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">run_phyFit.py</span> <span class="pre">[option]</span> <span class="pre">&lt;yaml.datei&gt;</span></code></p>
<p>auf der Kommandozeile.</p>
<ul class="simple">
<li><p><cite>simpleFit.fit</cite> zeigt am Beispiel der Anpassung einer Parabel,
wie mit ganz wenigen Eingaben eine Anpassung durchgeführt werden kann.</p></li>
<li><p><cite>xyFit.fit</cite> ist ein komplexeres Beispiel, das alle <em>phyFit</em>
unterstützten Arten von Unsicherheiten (d.h. x/y, absolut/relativ und
unabhängig/korreliert) enthält; relative Unsicherheiten werden dabei
auf den Modellwert und nicht auf die gemessenen Datenpunkte bezogen.</p></li>
<li><p><cite>hFit.fit</cite> zeigt die Anpassung einer Gaußverteilug an histogrammierte
Daten.</p></li>
</ul>
</div></blockquote>
<p><strong>Anpassungen mit kafe2go</strong></p>
<blockquote>
<div><p>Alternativ kann auch das Skript <em>kafe2go</em> aus dem Paket <em>kafe2</em>, verwendet
werden, mit dem ebenfalls Anpassungen von Modellen an Messdaten ohne eigenen
<em>Python</em>-Code erstellt weden können. Ausgeführt wird die Anpassung durch
Eingabe von</p>
<p><code class="docutils literal notranslate"><span class="pre">kafe2go</span> <span class="pre">[option]</span> <span class="pre">&lt;yaml.datei&gt;</span></code></p>
<p>auf der Kommandozeile.</p>
<p>Für Nutzer von MS-Windows gibt es eine ausführbare Datei, <cite>kafe2go.exe</cite>.
Zur Anwendung wird eine der Beispieldateien mit Rechtsklick angewählt
und mit der Anwendung <cite>kafe2go.exe</cite> geöffnet.</p>
<ul class="simple">
<li><p><cite>kafe2go_simleFit.fit</cite> zeigt am Beispiel der Anpassung einer Parabel,
wie mit ganz wenigen Eingaben eine Anpassung durchgeführt werden kann.</p></li>
<li><p><cite>kafe2go_xyFit.fit</cite> ist ein komplexeres Beispiel, das alle von <em>kafe2</em>
unterstützten Arten von Unsicherheiten (d.h. x/y, absolut/relativ und
unabhängig/korreliert) enthält; relative Unsicherheiten werden dabei
auf den Modellwert und nicht auf die gemessenen Datenpunkte bezogen.</p></li>
</ul>
</div></blockquote>
<p><strong>Konversion aus csv-Format nach yaml</strong></p>
<blockquote>
<div><p>Mit dem Programm _csv2yml.py_ können Daten im (spaltenweise organisierten)
<em>csv</em>-Format in einen <em>yaml</em>-Datenblock konveriert werden, den man dann
direkt mit Hilfe eines Text-Editors in eine <em>yaml</em>-Datei einfügen kann.</p>
</div></blockquote>
</div>
<div class="section" id="module-PhyPraKit">
<span id="module-documentation"></span><h2>Module Documentation<a class="headerlink" href="#module-PhyPraKit" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt><strong>PhyPraKit</strong>  </dt><dd><p>a collection of tools for data handling, visualisation and analysis 
in Physics Lab Courses, recommended for “Physikalisches Praktikum am KIT”</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.A0_readme">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">A0_readme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.A0_readme" title="Permalink to this definition">¶</a></dt>
<dd><p>Package PhyPraKit</p>
<p><strong>PhyPraKit</strong>  for Data Handling, Visualisation and Analysis</p>
<p>contains the following functions:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Data input/output:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>readColumnData() read data and meta-data from text file</p></li>
<li><p>readCSV()        read data in csv-format from file with header</p></li>
<li><p>readtxt()        read data in “txt”-format from file with header</p></li>
<li><p>readPicoScope()  read data from PicoScope</p></li>
<li><p>readCassy()      read CASSY output file in .txt format</p></li>
<li><p>labxParser()     read CASSY output file, .labx format</p></li>
<li><p>writeCSV()       write data in csv-format (opt. with header)</p></li>
<li><p>writeTexTable()  write data in LaTeX table format</p></li>
<li><p>round_to_error() round to same number of significant digits as uncertainty</p></li>
<li><p>ustring()        return rounded value +/- uncertainty as formatted string;   
alternative: the data type <em>ufloat(v,u)</em> of package <em>uncertainties</em> comfortably 
supports printing of values <em>v</em> with uncertainties <em>u</em>.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>signal processing:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>offsetFilter()      subtract an offset in array a</p></li>
<li><p>meanFilter()        apply sliding average to smoothen data</p></li>
<li><p>resample()          average over n samples</p></li>
<li><p>simplePeakfinder()  find peaks and dips in an array,    
<cite>(recommend to use convolutionPeakfinder)</cite></p></li>
<li><p>convolutionPeakfinder() find maxima (peaks) in an array</p></li>
<li><p>convolutionEdgefinder() find maxima of slope (rising) edges in an array</p></li>
<li><p>Fourier_fft()       fast Fourier transformation of an array</p></li>
<li><p>FourierSpectrum()   Fourier transformation of an array   
<cite>(slow, preferably use fft version)</cite></p></li>
<li><p>autocorrelate()     auto-correlation function</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>statistics:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>wmean                  calculate weighted mean</p></li>
<li><p>BuildCovarianceMatrix  build covariance matrix from individual uncertainties</p></li>
<li><p>Cov2Cor                convert covariance matrix to correlation matrix</p></li>
<li><p>Cor2Cov                convert correlation matrix + errors to covariance matrix</p></li>
<li><p>chi2prob               caclulate chi^2 probability</p></li>
<li><p>propagatedError        determine propagated uncertainty, with covariance;  
hint: the data type <em>ufloat(v,u)</em> of package <em>uncertainties</em> comfortably supports 
functions of values <em>v</em> with uncertainties <em>u</em> with correct error propagation</p></li>
<li><p>getModelError          determine uncertainty of parameter-dependent model function</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>histograms tools:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>barstat()   statistical information (mean, sigma, error_on_mean) from bar chart</p></li>
<li><p>nhist()    histogram plot based on np.historgram() and plt.bar()    
<cite>better use matplotlib.pyplot.hist()</cite></p></li>
<li><p>histstat() statistical information from 1d-histogram</p></li>
<li><p>nhist2d()  2d-histotram plot based on np.histrogram2d, plt.colormesh()  
<cite>(better use matplotlib.pyplot.hist2d)</cite></p></li>
<li><p>hist2dstat() statistical information from 2d-histogram</p></li>
<li><p>profile2d()  “profile plot” for 2d data</p></li>
<li><p>chi2p_indep2d() chi2 test on independence of data</p></li>
<li><p>plotCorrelations()  distributions and correlations of a multivariate data set</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>linear regression and function fitting:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>linRegression()    linear regression, y=ax+b, with analytical formula</p></li>
<li><p>odFit()            fit function with x and y errors (wit package <em>scipy</em> <em>ODR</em>)</p></li>
<li><p>xyFit()            fit with with correlated x and y errors,
profile likelihood and contour lines (module phyFit)</p></li>
<li><p>xFit()             fit of parameters to indexed data x_i (module <em>phyFit</em>)</p></li>
<li><p>hFit()             fit of a density to histogram data (module <em>phyFit</em>)</p></li>
<li><p>mFit()             fit of a user-defined cost function, or of a density 
to unbinned data (module <em>phyFit</em>)</p></li>
<li><p>k2Fit()            fit function with (correlated) errors on x and y  
with package kafe2</p></li>
<li><p>k2hFit()            fit of a density to histogram data   
with package kafe2</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>simulated data with MC-method:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>smearData()          add random deviations to input data</p></li>
<li><p>generateXYdata()     generate simulated data</p></li>
</ul>
</div></blockquote>
<p>phyFit fitting package for binned and unbinned ML fits and ML fits to (x,y) data</p>
<blockquote>
<div><ul class="simple">
<li><p>mFit()             unbinned ML fit with user-defined negLogL or PDF</p></li>
<li><p>hFit()             fit to binned histogram data</p></li>
<li><p>xFit()             fit of parameters to indexed data x_i, with x_i=x_i(x_j, *par)</p></li>
<li><p>xyFit()            fit to (x,y) data with y = f(x; *par)</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>helper functions</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>check_function_code()    check Python code before using it in exec() command</p></li>
<li><p>csv2yaml()               convert csv format to yaml data block</p></li>
<li><p>plot_xy_from_yaml()      plot (xy) data from yaml file</p></li>
<li><p>plot_hist_from_yaml()    plot histogram data from yaml file</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.BuildCovarianceMatrix">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">BuildCovarianceMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.BuildCovarianceMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a covariance matrix 
from independent and correlated error components</p>
<dl class="simple">
<dt>Args: </dt><dd><ul class="simple">
<li><p>sig: iterable of independent errors</p></li>
<li><p>sigc: list of iterables of correlated uncertainties</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><p>covariance Matrix as numpy-array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.Cor2Cov">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">Cor2Cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.Cor2Cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a correlation matrix and error into covariance matrix</p>
<dl class="simple">
<dt>Args: </dt><dd><ul class="simple">
<li><p>sig: 1d numpy array of correlated uncertainties</p></li>
<li><p>C: correlation matrix as numpy array</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>V: covariance matrix as numpy array</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.Cov2Cor">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">Cov2Cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.Cov2Cor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a covariance matrix into diagonal errors + correlation matrix</p>
<dl class="simple">
<dt>Args: </dt><dd><ul class="simple">
<li><p>V: covariance matrix as numpy array</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>diag uncertainties (sqrt of diagonal elements)</p></li>
<li><p>C: correlation matrix as numpy array</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.FourierSpectrum">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">FourierSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.FourierSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Fourier transform of amplitude spectrum a(t), for equidistant sampling
times (a simple implementation for didactical purpose only,
consider using <code class="docutils literal notranslate"><span class="pre">Fourier_fft()</span></code> )</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>t: np-array of time values</p></li>
<li><p>a: np-array amplitude a(t)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>arrays freq, amp: frequencies and amplitudes</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.Fourier_fft">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">Fourier_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.Fourier_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Fourier transform of the amplitude spectrum a(t)</p>
<dl>
<dt>method: </dt><dd><p>uses <cite>numpy.fft</cite> and <cite>numpy.fftfreq</cite>; 
output amplitude is normalised to number of samples;</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>t: np-array of time values</p></li>
<li><p>a: np-array amplidude a(t)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>arrays f, a_f: frequencies and amplitudes</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.autocorrelate">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">autocorrelate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.autocorrelate" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate auto-correlation function of input array</p>
<p>method: for array of length l, calculate 
a[0]=sum_(i=0)^(l-1) a[i]*[i] and 
a[i]= 1/a[0] * sum_(k=0)^(l-i) a[i] * a[i+k-1] for i=1,l-1</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>a: np-array</p></li>
</ul>
</dd>
<dt>Returns </dt><dd><ul class="simple">
<li><p>np-array of len(a), the auto-correlation function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.barstat">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">barstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bincont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bincent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.barstat" title="Permalink to this definition">¶</a></dt>
<dd><p>statistics from a bar chart (histogram) 
with given bin contents and bin centres</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>bincont: array with bin content</p></li>
<li><p>bincent: array with bin centres</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: mean, sigma and sigma on mean</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.check_function_code">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">check_function_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.check_function_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Check Python code before using it in exec() command</p>
<p>Watch out for “dangerous” actions</p>
<blockquote>
<div><dl class="simple">
<dt>Args: </dt><dd><ul class="simple">
<li><p>user-defined code</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>function name</p></li>
<li><p>code</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.chi2p_indep2d">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">chi2p_indep2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.chi2p_indep2d" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a chi2-test on independence of x and y</p>
<p>method: chi2-test on compatibility of 2d-distribution, f(x,y),
with product of marginal distributions, f_x(x) * f_y(y)</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>H2d: histogram array (as returned by histogram2d)</p></li>
<li><p>bcx: bin contents x (marginal distribution x)</p></li>
<li><p>bcy: bin contents y (marginal distribution y)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: p-value w.r.t. assumption of independence</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.chi2prob">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">chi2prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.chi2prob" title="Permalink to this definition">¶</a></dt>
<dd><p>chi2-probability</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>chi2: chi2 value</p></li>
<li><p>ndf: number of degrees of freedom</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: chi2 probability</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.convolutionEdgefinder">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">convolutionEdgefinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.convolutionEdgefinder" title="Permalink to this definition">¶</a></dt>
<dd><p>find positions of maximal positive slope in data</p>
<dl class="simple">
<dt>method: </dt><dd><p>convolute array <cite>a</cite> with an edge template of given width and
return extrema of convoluted signal, i.e. places of rising edges</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>a: array-like, input data</p></li>
<li><p>width: int, width of signal to search for</p></li>
<li><p>th: float, 0.&lt;= th &lt;=1., relative threshold above (global)minimum</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>pidx: list, indices (in original array) of rising edges</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.convolutionFilter">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">convolutionFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.convolutionFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>convolute normalized array with template function and return maxima</p>
<dl class="simple">
<dt>method: </dt><dd><p>convolute array a with a template and return extrema of 
convoluted signal, i.e. places where template matches best</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>a: array-like, input data</p></li>
<li><p>a: array-like, template</p></li>
<li><p>th: float, 0.&lt;= th &lt;=1., relative threshold for places of
best match above (global) minimum</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>pidx: list, indices (in original array) of best matches</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.convolutionPeakfinder">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">convolutionPeakfinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.convolutionPeakfinder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>find positions of all Peaks in data </dt><dd><p>(simple version for didactical purpose, 
consider using <code class="docutils literal notranslate"><span class="pre">scipy.signal.find_peaks_cwt()</span></code> )</p>
</dd>
<dt>method: </dt><dd><p>convolute array a with rectangular template of given width and
return extrema of convoluted signal, i.e. places where 
template matches best</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>a: array-like, input data</p></li>
<li><p>width: int, width of signal to search for</p></li>
<li><p>th: float, 0.&lt;= th &lt;=1., relative threshold for peaks above (global)minimum</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>pidx: list, indices (in original array) of peaks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.csv2yaml">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">csv2yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlhead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.csv2yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>read floating point data in general csv format and convert to yaml</p>
<p>skip header lines, replace decimal comma, remove special characters,
and ouput as yaml data block</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: file name or open file handler</p></li>
<li><p>nhead: number of header lines; keys taken from first header line</p></li>
<li><p>delim: column separator</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>hlines: list of string, header lines</p></li>
<li><p>ymltxt: list of text lines, each with yaml key and data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.generateXYdata">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">generateXYdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srelx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srely</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.generateXYdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate measurement data according to some model
assumes xdata is measured within the given uncertainties; 
the model function is evaluated at the assumed “true” values 
xtrue, and a sample of simulated measurements is obtained by 
adding random deviations according to the uncertainties given 
as arguments.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>xdata:  np-array, x-data (independent data)</p></li>
<li><p>model: function that returns (true) model data (y-dat) for input x</p></li>
<li><p>mpar: list of parameters for model (if any)</p></li>
</ul>
</dd>
<dt>the following are single floats or arrays of length of x</dt><dd><ul class="simple">
<li><p>sx: gaussian uncertainty(ies) on x</p></li>
<li><p>sy: gaussian uncertainty(ies) on y</p></li>
<li><p>srelx: relative Gaussian uncertainty(ies) on x</p></li>
<li><p>srely: relative Gaussian uncertainty(ies) on y</p></li>
</ul>
</dd>
<dt>the following are common (correlated) systematic uncertainties</dt><dd><ul class="simple">
<li><p>xabscor: absolute, correlated error on x</p></li>
<li><p>yabscor: absolute, correlated error on y</p></li>
<li><p>xrelcor: relative, correlated error on x</p></li>
<li><p>yrelcor: relative, correlated error on y</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-arrays of floats:</p>
<ul>
<li><p>xtrue: true x-values</p></li>
<li><p>ytrue: true value = model(xtrue)</p></li>
<li><p>ydata:  simulated data</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.getModelError">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">getModelError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcov</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.getModelError" title="Permalink to this definition">¶</a></dt>
<dd><p>determine uncertainty of model at x from parameter uncertainties</p>
<dl>
<dt>Formula: </dt><dd><p>Delta(x) = sqrt( sum_i,j (df/dp_i(x) df/dp_j(x) Vp_i,j) )</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>x: scalar or 1d-array of x values</p></li>
<li><p>model: model function</p></li>
<li><p>pvals: parameter values</p></li>
<li><p>covp: covariance matrix of parameters</p></li>
</ul>
<p>Returns:
* model uncertainty/ies, same length as x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.hFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">hFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.hFit" title="Permalink to this definition">¶</a></dt>
<dd><p>call hFit from .phyFit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.hist2dstat">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">hist2dstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.hist2dstat" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate statistical information from 2d Histogram</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>H2d: histogram array (as returned by histogram2d)</p></li>
<li><p>xed: bin edges in x</p></li>
<li><p>yed: bin edges in y</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: mean x</p></li>
<li><p>float: mean y</p></li>
<li><p>float: variance x</p></li>
<li><p>float: variance y</p></li>
<li><p>float: covariance of x and y</p></li>
<li><p>float: correlation of x and y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.histstat">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">histstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.histstat" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate mean, standard deviation and uncertainty on mean 
of a histogram with bin-contents <cite>binc</cite> and bin-edges <cite>bine</cite></p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>binc: array with bin content</p></li>
<li><p>bine: array with bin edges</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: mean, sigma and sigma on mean</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.k2Fit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">k2Fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srelx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srely</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x-data',</span> <span class="pre">'y-data']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\pm</span> <span class="pre">1</span> <span class="pre">\\sigma$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asym_parerrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.k2Fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit an arbitrary function func(x, *par) to data points (x, y) 
with independent and correlated absolute and/or relative errors 
on x- and y- values with package iminuit.</p>
<p>Correlated absolute and/or relative uncertainties of input data 
are specified as numpy-arrays of floats; they enter in the 
diagonal and off-diagonal elements of the covariance matrix. 
Values of 0. may be specified for data points not affected
by a correlated uncertainty. E.g. the array [0., 0., 0.5., 0.5]
results in a correlated uncertainty of 0.5 of the 3rd and 4th 
data points. Providing lists of such array permits the construction
of arbitrary covariance matrices from independent and correlated
uncertainties uncertainties of (groups of) data points.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>func: function to fit</p></li>
<li><p>x:  np-array, independent data</p></li>
<li><p>y:  np-array, dependent data</p></li>
</ul>
<p>components of uncertainty (optional, use None if not relevant)</p>
<dl class="simple">
<dt>single float, array of length of x, or a covariance matrix</dt><dd><ul class="simple">
<li><p>sx: scalar, 1d or 2d np-array, uncertainty(ies) on x</p></li>
<li><p>sy: scalar, 1d or 2d np-array, uncertainty(ies) on y</p></li>
</ul>
</dd>
<dt>single float or array of length of x</dt><dd><ul class="simple">
<li><p>srelx: scalar or 1d np-array, relative uncertainties x</p></li>
<li><p>srely: scalar or 1d np-array, relative uncertainties y</p></li>
</ul>
</dd>
<dt>single float or array of length of x, or a list of such objects, </dt><dd><p>used to construct a covariance matrix from components</p>
<ul class="simple">
<li><p>xabscor: scalar or 1d np-array, absolute, correlated error(s) on x</p></li>
<li><p>yabscor: scalar or 1d np-array, absolute, correlated error(s) on y</p></li>
<li><p>xrelcor: scalar or 1d np-array, relative, correlated error(s) on x</p></li>
<li><p>yrelcor: scalor or 1d np-array, relative, correlated error(s) on y</p></li>
</ul>
</dd>
<dt>fit options</dt><dd><ul class="simple">
<li><p>ref_to_model, bool: refer relative errors to model if true,
else use measured data</p></li>
<li><p>p0: array-like, initial guess of parameters</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties</p></li>
<li><p>parameter constraints: (name, value, uncertainty)</p></li>
<li><p>limits: (nested) list(s) (name, min, max)</p></li>
</ul>
</dd>
<dt>output options</dt><dd><ul class="simple">
<li><p>plot: flag to switch off graphical output</p></li>
<li><p>axis_labels: list of strings, axis labels x and y</p></li>
<li><p>data_legend: legend entry for data points</p></li>
<li><p>model_name: latex name for model function</p></li>
<li><p>model_expression: latex expression for model function</p></li>
<li><p>model_legend: legend entry for model</p></li>
<li><p>model_band: legend entry for model uncertainty band</p></li>
<li><p>fit_info: controls display of fit results on figure</p></li>
<li><p>plot_band: suppress model uncertainty-band if False</p></li>
<li><p>asym_parerrs: show (asymmetric) errors from profile-likelihood scan</p></li>
<li><p>plot_cor: show profile curves and contour lines</p></li>
<li><p>showplots: show plots on screen, default = True</p></li>
<li><p>quiet: controls text output</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>list: parameter names</p></li>
<li><p>np-array of float: parameter values</p></li>
<li><p>np-array of float: negative and positive parameter errors</p></li>
<li><p>np-array: cor   correlation matrix</p></li>
<li><p>float: chi2  chi-square</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.k2hFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">k2hFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_GaussApprox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'counts/bin</span> <span class="pre">=</span> <span class="pre">f(x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Histogram</span> <span class="pre">Data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\pm</span> <span class="pre">1</span> <span class="pre">\\sigma$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asym_parerrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.k2hFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to fit a density distribution f(x, *par) 
to binned data (histogram) with class mnFit</p>
<p>The cost function is two times the negative log-likelihood of the 
Poisson  distribution, or - optionally - of the Gaussian approximation.</p>
<p>Uncertainties are determined from the model values in order to avoid biases 
and to take account of empty bins of an histogram.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>fitf: model function to fit, arguments (float:x, float: *args)</p></li>
<li><p>data: the data to be histogrammed</p></li>
<li><p>bin_edges: bin edges</p></li>
</ul>
<p>fit options</p>
<blockquote>
<div><ul class="simple">
<li><p>p0: array-like, initial guess of parameter values</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties</p></li>
<li><p>constraints: (nested) list(s) [name or id, value, error]</p></li>
<li><p>limits: (nested) list(s) [name or id, min, max]</p></li>
<li><p>use_GaussApprox: Gaussian approximation instead of Poisson</p></li>
</ul>
</div></blockquote>
<p>output options</p>
<blockquote>
<div><ul class="simple">
<li><p>plot: show data and model if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_residual: also plot residuals w.r.t. model</p></li>
<li><p>showplots: show plots on screen</p></li>
<li><p>quiet: suppress printout</p></li>
<li><p>axis_labes: list of tow strings, axis labels</p></li>
<li><p>data_legend: legend entry for data</p></li>
<li><p>model_legend: legend entry for model</p></li>
<li><p>plot: flag to switch off graphical output</p></li>
<li><p>axis_labels: list of strings, axis labels x and y</p></li>
<li><p>model_name: latex name for model function</p></li>
<li><p>model_expression: latex expression for model function</p></li>
<li><p>model_band: legend entry for model uncertainty band</p></li>
<li><p>fit_info: controls display of fit results on figure</p></li>
<li><p>asym_parerrs: show (asymmetric) errors from profile-likelihood scan</p></li>
</ul>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>list: parameter names</p></li>
<li><p>np-array of float: parameter values</p></li>
<li><p>np-array of float: negative and positive parameter errors</p></li>
<li><p>np-array: cor   correlation matrix</p></li>
<li><p>float: goodness-of-fit (equiv. chi2 for large number of entries/bin)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.labxParser">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">labxParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.labxParser" title="Permalink to this definition">¶</a></dt>
<dd><p>read files in xml-format produced with Leybold CASSY</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file:  input data in .labx format</p></li>
<li><p>prlevel: control printout level, 0=no printout</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>list of strings: tags of measurement vectors</p></li>
<li><p>2d list:         measurement vectors read from file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.linRegression">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">linRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.linRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>linear regression y(x) = ax + b</p>
<dl class="simple">
<dt>method: </dt><dd><p>analytical formula</p>
</dd>
</dl>
<p>Args:
* x: np-array, independent data
* y: np-array, dependent data
* sy: scalar or np-array, uncertainty on y</p>
<p>Returns:
* float: a     slope
* float: b     constant
* float: sa  sigma on slope
* float: sb  sigma on constant
* float: cor   correlation
* float: chi2  chi-square</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.mFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">mFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.mFit" title="Permalink to this definition">¶</a></dt>
<dd><p>call mFit from .phyFit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.meanFilter">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">meanFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.meanFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a sliding average to smoothen data,</p>
<dl>
<dt>method:</dt><dd><p>value at index i and int(width/2) neighbours are averaged
to from the new value at index i</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>a: np-array of values</p></li>
<li><p>width: int, number of points to average over
(if width is an even number, width+1 is used)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>av  smoothed signal curve</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.nhist">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">nhist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frequency'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.nhist" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram.hist
show a one-dimensional histogram</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>data: array containing float values to be histogrammed</p></li>
<li><p>bins: number of bins</p></li>
<li><p>xlabel: label for x-axis</p></li>
<li><p>ylabel: label for y axix</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float arrays: bin contents and bin edges</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.nhist2d">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">nhist2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x</span> <span class="pre">axis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y</span> <span class="pre">axis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'counts'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.nhist2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Histrogram.hist2d
create and plot a 2-dimensional histogram</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>x: array containing x values to be histogrammed</p></li>
<li><p>y: array containing y values to be histogrammed</p></li>
<li><p>bins: number of bins</p></li>
<li><p>xlabel: label for x-axis</p></li>
<li><p>ylabel: label for y axix</p></li>
<li><p>clabel: label for colour index</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float array: array with counts per bin</p></li>
<li><p>float array: histogram edges in x</p></li>
<li><p>float array: histogram edges in y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.odFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">odFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.odFit" title="Permalink to this definition">¶</a></dt>
<dd><p>fit an arbitrary function with errors on x and y
uses numerical “orthogonal distance regression” from package scipy.odr</p>
<p>Args:
* fitf: function to fit, arguments (array:P, float:x)
* x:  np-array, independent data
* y:  np-array, dependent data
* sx: scalar or np-array, uncertainty(ies) on x      
* sy: scalar or np-array, uncertainty(ies) on y
* p0: array-like, initial guess of parameters</p>
<p>Returns:
* np-array of float: parameter values
* np-array of float: parameter errors
* np-array: cor   correlation matrix 
* float: chi2  chi-square</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.offsetFilter">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">offsetFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.offsetFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>correct an offset in array a 
(assuming a symmetric signal around zero)
by subtracting the mean</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.plotCorrelations">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">plotCorrelations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.plotCorrelations" title="Permalink to this definition">¶</a></dt>
<dd><p>plot histograms and sctter plots of value pairs as array of axes</p>
<p>Args:</p>
<ul class="simple">
<li><p>vals: list of arrays [[v1_1, …], …, [vn_1, …]] of float, input data</p></li>
<li><p>names: list of labels for variables v1 to vn</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>figure</p></li>
<li><p>axarray: array of axes</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.plot_hist_from_yaml">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">plot_hist_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.plot_hist_from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>plot histogram data from yaml file</p>
<blockquote>
<div><p>Input:</p>
<blockquote>
<div><p>dictionary from yaml input</p>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><p>matplotlib figure</p>
</div></blockquote>
</div></blockquote>
<p>yaml-format of input:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">raw_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x1</span><span class="p p-Indicator">,</span> <span class="nv">...</span> <span class="p p-Indicator">,</span> <span class="nv">xn</span><span class="p p-Indicator">]</span>
<span class="c1"># define binning</span>
<span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">n</span>
<span class="nt">bin_range</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x_min</span><span class="p p-Indicator">,</span> <span class="nv">x_max</span><span class="p p-Indicator">]</span>
<span class="c1">#   alternatively: </span>
<span class="c1"># bin edges: [e0, ..., e_n]</span>

<span class="l l-Scalar l-Scalar-Plain">several input sets to be separated by</span> 
<span class="nn">...</span>
<span class="nn">---</span>   
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.plot_xy_from_yaml">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">plot_xy_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.plot_xy_from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>plot (xy) data from yaml file</p>
<blockquote>
<div><p>Input:</p>
<blockquote>
<div><p>dictionary from yaml input</p>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><p>matplotlib figure</p>
</div></blockquote>
</div></blockquote>
<p>yaml-format of input:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">x values</span> <span class="p p-Indicator">]</span>
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">y values</span> <span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-uncertainty or [x-uncertainties]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">y-uncertainty or [y-uncertainties]</span>

<span class="l l-Scalar l-Scalar-Plain">several input sets to be separated by</span> 
<span class="nn">...</span>
<span class="nn">---</span>   
</pre></div>
</div>
<p>In case a model function is also supplied, it is overlayed in the 
output graph. The corresponding <em>yaml</em> block looks as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># optional model specification</span>
<span class="nt">model_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;model name&gt;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;Python code of model function&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.profile2d">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">profile2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.profile2d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>generate a profile plot from 2d histogram:</dt><dd><ul class="simple">
<li><p>mean y at a centre of x-bins, standard deviations as error bars</p></li>
</ul>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>H2d: histogram array (as returned by histogram2d)</p></li>
<li><p>xed: bin edges in x</p></li>
<li><p>yed: bin edges in y</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: array of bin centres in x</p></li>
<li><p>float: array mean</p></li>
<li><p>float: array rms</p></li>
<li><p>float: array sigma on mean</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.propagatedError">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">propagatedError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcov</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.propagatedError" title="Permalink to this definition">¶</a></dt>
<dd><p>determine propageted uncertainty (with covariance matrix)</p>
<p>Formula: 
Delta = sqrt( sum_i,j (df/dp_i df/dp_j Vp_i,j) )</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>function: function of parameters pvals, 
a 1-d array is also allowed, eg. function(*p) = f(x, *p)</p></li>
<li><p>pvals: parameter values</p></li>
<li><p>pcov: covariance matrix (or uncertainties) of parameters</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>uncertainty Delta( function(*par) )</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.readCSV">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">readCSV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlhead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.readCSV" title="Permalink to this definition">¶</a></dt>
<dd><p>read Data in .csv format, skip header lines</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>nhead: number of header lines to skip</p></li>
<li><p>delim: column separator</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>hlines: list of string, header lines</p></li>
<li><p>data: 2d array, 1st index for columns</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.readCassy">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">readCassy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.readCassy" title="Permalink to this definition">¶</a></dt>
<dd><p>read Data exported from Cassy in .txt format</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>prlevel: printout level, 0 means silent</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>units: list of strings, channel units</p></li>
<li><p>data: tuple of arrays, channel data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.readColumnData">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">readColumnData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cchar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.readColumnData" title="Permalink to this definition">¶</a></dt>
<dd><p>read column-data from file</p>
<ul class="simple">
<li><p>input is assumed to be columns of floats</p></li>
<li><p>characters following &lt;cchar&gt;, and &lt;cchar&gt; itself, are ignored</p></li>
<li><p>words with preceding ‘*’ are taken as keywords for meta-data,
text following the keyword is returned in a dictionary</p></li>
</ul>
<p>Args:</p>
<ul class="simple">
<li><p>string fnam:      file name</p></li>
<li><p>int ncols:        number of columns</p></li>
<li><p>char delimiter:   character separating columns</p></li>
<li><p>bool pr:          print input to std out if True</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.readPicoScope">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">readPicoScope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.readPicoScope" title="Permalink to this definition">¶</a></dt>
<dd><p>read Data exported from PicoScope in .txt or .csv format</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>prlevel: printout level, 0 means silent</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>units: list of strings, channel units</p></li>
<li><p>data: tuple of arrays, channel data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.readtxt">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">readtxt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlhead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.readtxt" title="Permalink to this definition">¶</a></dt>
<dd><p>read floating point data in general txt format
skip header lines, replace decimal comma, remove special characters</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>nhead: number of header lines to skip</p></li>
<li><p>delim: column separator</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>hlines: list of string, header lines</p></li>
<li><p>data: 2d array, 1st index for columns</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.resample">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>perform average over n data points of array a, 
return reduced array, eventually with corresponding time values</p>
<dl>
<dt>method:</dt><dd><p>value at index <cite>i</cite> and <cite>int(width/2)</cite> neighbours are averaged
to from the new value at index <cite>i</cite></p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>a, t: np-arrays of values of same length</p></li>
<li><p>width: int, number of values of array <cite>a</cite> to average over
(if width is an even number, width+1 is used)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>av: array with reduced number of samples</p></li>
<li><p>tav:  a second, related array with reduced number of samples</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.round_to_error">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">round_to_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsd_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.round_to_error" title="Permalink to this definition">¶</a></dt>
<dd><p>round float <em>val</em> to corresponding number of significant digits  
as uncertainty <em>err</em></p>
<dl class="simple">
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>val, float: value</p></li>
<li><p>err, float: uncertainty of value</p></li>
<li><p>nsd_e, int: number of significant digits of err</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>int:   number of significant digits for v</p></li>
<li><p>float: val rounded to precision of err</p></li>
<li><p>float: err rounded to precision nsd_e</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.simplePeakfinder">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">simplePeakfinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.simplePeakfinder" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>find positions of all maxima (peaks) in data</dt><dd><p>x-coordinates are determined from weighted average over 3 data points</p>
</dd>
<dt>this only works for very smooth data with well defined extrema</dt><dd><p>use <code class="docutils literal notranslate"><span class="pre">convolutionPeakfinder</span></code> or <code class="docutils literal notranslate"><span class="pre">scipy.signal.argrelmax()</span></code> instead</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>x: np-array of positions</p></li>
<li><p>a: np-array of values at positions x</p></li>
<li><p>th: float, threshold for peaks</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-array: x positions of peaks as weighted mean over neighbours</p></li>
<li><p>np-array: y values corresponding to peaks</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.smearData">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">smearData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.smearData" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate measurement data from “true” input 
by adding random deviations according to the uncertainties</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>d:  np-array, (true) input data</p></li>
</ul>
</dd>
<dt>the following are single floats or arrays of length of array d</dt><dd><ul class="simple">
<li><p>s: Gaussian uncertainty(ies) (absolute)</p></li>
<li><p>srel: Gaussian uncertainties (relative)</p></li>
</ul>
</dd>
<dt>the following are common (correlated) systematic uncertainties</dt><dd><ul class="simple">
<li><p>abscor: 1d np-array of floats or list of np-arrays:
absolute correlated uncertainties</p></li>
<li><p>relcor: 1d np-array of floats or list of np-arrays:
relative correlated uncertainties</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-array of floats: dm, smeared (=measured) data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.ustring">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">ustring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.ustring" title="Permalink to this definition">¶</a></dt>
<dd><p>v +/- e as formatted string 
with number of significant digits corresponding to 
precision pe of uncertainty</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>v: value</p></li>
<li><p>e: uncertainty</p></li>
<li><p>pe: precision (=number of significant digits) of uncertainty</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>string: &lt;v&gt; +/- &lt;e&gt; with appropriate number of digits</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.wmean">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">wmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.wmean" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted mean of np-array x with uncertainties sx 
or covariance matrix V; if both are given, sx**2 is added 
to the diagonal elements of the covariance matrix</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>x: np-array of values</p></li>
<li><p>sx: np-array uncertainties</p></li>
<li><p>V: optional, covariance matrix of x</p></li>
<li><p>pr: if True, print result</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>float: mean, sigma</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.writeCSV">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">writeCSV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.10g'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\n'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.writeCSV" title="Permalink to this definition">¶</a></dt>
<dd><p>write data in .csv format, including header lines</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>ldata: list of columns to be written</p></li>
<li><p>hlines: list with header lines (optional)</p></li>
<li><p>fmt: format string (optional)</p></li>
<li><p>delim: delimiter to separate values (default comma)</p></li>
<li><p>nline: newline string</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>0/1  for success/fail</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.writeTexTable">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">writeTexTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.10g'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.writeTexTable" title="Permalink to this definition">¶</a></dt>
<dd><p>write data formatted as latex tabular</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file: string, file name</p></li>
<li><p>ldata: list of columns to be written</p></li>
<li><p>cnames: list of column names (optional)</p></li>
<li><p>caption: LaTeX table caption (optional)</p></li>
<li><p>fmt: format string (optional)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>0/1 for success/fail</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.xFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">xFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.xFit" title="Permalink to this definition">¶</a></dt>
<dd><p>call xFit from .phyFit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.xyFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.</span></span><span class="sig-name descname"><span class="pre">xyFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.xyFit" title="Permalink to this definition">¶</a></dt>
<dd><p>call xyFit from .phyFit</p>
</dd></dl>

<span class="target" id="module-PhyPraKit.phyFit"></span><p>package phyFit.py</p>
<blockquote>
<div><p>Physics Fitting with <cite>iminiut</cite> [<a class="reference external" href="https://iminuit.readthedocs.ios/en/stable/">https://iminuit.readthedocs.ios/en/stable/</a>]</p>
<p>Author: Guenter Quast, initial version Jan. 2021, updated Jun. 2021</p>
<dl class="simple">
<dt>Requirements: </dt><dd><ul class="simple">
<li><p>Python &gt;= 3.6</p></li>
<li><p>iminuit vers. &gt; 2.0</p></li>
<li><p>scipy &gt; 1.5.0</p></li>
<li><p>matplotlib &gt; 3</p></li>
</ul>
</dd>
</dl>
<p>The class <cite>mnFit.py</cite> uses the optimization and uncertainty-estimation
package <cite>iminuit</cite> for fitting a parameter-dependent model f(x, *par) 
to data points (x, y) or a probability density function to binned 
histogram data or to unbinned data. Parameter estimation is based on 
pre-implemented Maximum-Likelihood methods, or on a user-defined 
cost function in the latter case, which provides maximum flexibility.
Classical least-square methods are optionally available for comparison 
with other packages.</p>
<p>A unique feature of the package is the support of different kinds 
of uncertainties for x-y data, namely independent and/or correlated 
absolute and/or relative uncertainties in the x and/or y directions. 
Parameter estimation for density distributions is based on the shifted 
Poisson distribution, Poisson(x - loc, lambda), of the number of entries 
in each bin of a histogram.</p>
<p>Parameter constraints, i.e. external knowledge of parameters within
Gaussian uncertainties, limits on parameters in order to avoid 
problematic regions in parameter space during the minimization process, 
and fixing of parameters, e.g. to include the validity range of a model
in the parameters without affecting the fit, are also supported by <em>mnFit</em>.</p>
<dl class="simple">
<dt>Method:</dt><dd><p>Uncertainties that depend on model parameters are treated by dynamically 
updating the cost function during the fitting process with <cite>iminuit</cite>.
Data points with relative errors can thus be referred to the model 
instead of the data. The derivative of the model function w.r.t. x is 
used to project the covariance matrix of x-uncertainties on the y-axis.</p>
</dd>
</dl>
<p>Example functions <em>xyFit()</em>, <em>hFit()</em> and <em>mFit()</em>, illustrate how to 
control the  interface of <cite>mnFit</cite>. A short example script is also 
provided to perform fits on sample data. The sequence of steps performed
by these interface functions is rather general and straight-forward:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Fit</span> <span class="o">=</span> <span class="n">mnFit</span><span class="p">(</span><span class="n">fit_type</span><span class="p">)</span>                <span class="c1"># initialize a mnFit object </span>
<span class="n">Fit</span><span class="o">.</span><span class="n">setOptions</span><span class="p">(</span><span class="n">run_minos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>  <span class="c1"># set options</span>
<span class="n">Fit</span><span class="o">.</span><span class="n">init_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameters</span> <span class="o">...</span><span class="p">)</span>  <span class="c1"># initialize data container</span>
<span class="n">Fit</span><span class="o">.</span><span class="n">init_fit</span><span class="p">(</span><span class="n">ufcn</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">p0</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>     <span class="c1"># initialize Fit (and minuit)</span>
<span class="n">resultDict</span> <span class="o">=</span> <span class="n">Fit</span><span class="o">.</span><span class="n">do_fit</span><span class="p">()</span>            <span class="c1"># perform the fit (returns dictionary)</span>
<span class="n">resultTuple</span> <span class="o">=</span> <span class="n">Fit</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>        <span class="c1"># retrieve results as tuple of np-arrays</span>
<span class="n">Fit</span><span class="o">.</span><span class="n">plotModel</span><span class="p">()</span>                      <span class="c1"># plot data and best-fit model</span>
<span class="n">Fit</span><span class="o">.</span><span class="n">plotContours</span><span class="p">()</span>                   <span class="c1"># plot profiles and confidence contours</span>
</pre></div>
</div>
<p>It is also possible to run a fit without the need to provide own
Python code. In this case, the data, uncertainties and the model
are read from a file in yaml format and passed to the function 
xyFit_from_yaml() as a dictionary.</p>
<p>The implementation of the fitting procedure in this package is 
- intentionally - rather minimalistic, and it is meant to 
illustrate the principles of an advanced usage of <cite>iminuit</cite>. It 
is also intended to stimulate own applications of special, 
user-defined cost functions.</p>
<dl class="simple">
<dt>The main features of this package are:</dt><dd><ul class="simple">
<li><p>provisioning of cost functions for x-y and binned histogram fits</p></li>
<li><p>implementation of the least-squares method for correlated Gaussian errors</p></li>
<li><p>support for correlated x-uncertainties by projection on the y-axis</p></li>
<li><p>support of relative errors with reference to the model values</p></li>
<li><p>shifted Poisson distribution for binned likelihood fits to histograms</p></li>
<li><p>evaluation of profile likelihoods to determine asymmetric uncertainties</p></li>
<li><p>plotting of profile likelihood and confidence contours</p></li>
</ul>
</dd>
</dl>
<p>The <strong>cost function</strong> that is optimized for x-y fits basically is a 
least-squares one, which is extended if parameter-dependent uncertainties 
are present. In the latter case, the logarithm of the determinant of the 
covariance matrix is added to the least-squares cost function, so that it 
corresponds to twice the negative log-likelihood of a multivariate Gaussian 
distribution. Fits to histogram data rely on the negative log-likelihood
of the Poisson distribution, generalized to support fractional observed 
values, which may occur if corrections to the observed bin counts have 
to be applied. If there is a difference <em>DeltaMu</em> between the mean value
and the variance of the number of entries in a bin due to corrections, 
a “shifted Poisson distribution”, Poiss(x-DeltaMu, lambda), is supported.</p>
<p>Fully functional applications of the package are illustrated in executable
script below, which contains sample data, executes the fitting procedure
and collects and displays the results.</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.get_functionSignature">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">get_functionSignature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.get_functionSignature" title="Permalink to this definition">¶</a></dt>
<dd><p>get arguments and keyword arguments passed to a function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.hFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">hFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_contents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DeltaMu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_GaussApprox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'counts/bin</span> <span class="pre">=</span> <span class="pre">f(x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Histogram</span> <span class="pre">Data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.hFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to fit a density distribution f(x, *par) 
to binned data (histogram) with class mnFit</p>
<p>The cost function is two times the negative log-likelihood of the Poisson 
distribution, or - optionally - of the Gaussian approximation.</p>
<p>Uncertainties are determined from the model values in order to avoid biases 
and to take account of empty bins of an histogram. The default behaviour is 
to fit a normalised density; optionally, it is also possible to fit the 
number of bin entries.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>fitf: model function to fit, arguments (float:x, float: *args)</p></li>
<li><p>bin_contents:</p></li>
<li><p>bin_edges:</p></li>
<li><p>DeltaMu: shift mean (=mu) vs. variance (=lam), for Poisson: mu=lam</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: array-like, initial guess of parameters</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>constraints: (nested) list(s) [name or id, value, error]</p></li>
<li><p>limits: (nested) list(s) [name or id, min, max]</p></li>
<li><p>use_GaussApprox: Gaussian approximation instead of Poisson</p></li>
<li><p>density: fit density (not number of events)</p></li>
<li><p>plot: show data and model if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_residual: plot residuals w.r.t. model instead of model function</p></li>
<li><p>showplots: show plots on screen</p></li>
<li><p>quiet: suppress printout</p></li>
<li><p>axis_labes: list of tow strings, axis labels</p></li>
<li><p>data_legend: legend entry for data</p></li>
<li><p>model_legend: legend entry for model</p></li>
<li><p>bool: for experts only, return instance of class mnFit to give access 
to data members and methods</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-array of float: parameter values</p></li>
<li><p>2d np-array of float: parameter uncertainties [0]: neg. and [1]: pos.</p></li>
<li><p>np-array: correlation matrix</p></li>
<li><p>float: 2*negLog L, corresponding to chi-square of fit a minimum</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.hFit_from_yaml">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">hFit_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.hFit_from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Binned log-likelihood fit to histogram data with input from yaml file with phyfit.hFit()</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>fd: fit input as a dictionary, extracted from a file in yaml format</p></li>
<li><p>plot: show data and model if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_residual: plot residuals w.r.t. model instead of model function</p></li>
<li><p>showplots: show plots on screen - switch off if handled by calling process</p></li>
<li><p>quiet: suppress informative printout</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>result dictionary</p></li>
<li><p>optionally: produces result plots</p></li>
</ul>
</dd>
</dl>
<p>simple example of <em>yaml</em> input:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of a fit to histogram data</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">histogram</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example data</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="s">&#39;h&#39;</span> 
<span class="nt">y_label</span><span class="p">:</span> <span class="s">&#39;pdf(h)&#39;</span>

<span class="c1"># data:</span>
<span class="nt">raw_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">79.83</span><span class="p p-Indicator">,</span><span class="nv">79.63</span><span class="p p-Indicator">,</span><span class="nv">79.68</span><span class="p p-Indicator">,</span><span class="nv">79.82</span><span class="p p-Indicator">,</span><span class="nv">80.81</span><span class="p p-Indicator">,</span><span class="nv">79.97</span><span class="p p-Indicator">,</span><span class="nv">79.68</span><span class="p p-Indicator">,</span><span class="nv">80.32</span><span class="p p-Indicator">,</span><span class="nv">79.69</span><span class="p p-Indicator">,</span><span class="nv">79.18</span><span class="p p-Indicator">,</span>
        <span class="nv">80.04</span><span class="p p-Indicator">,</span><span class="nv">79.80</span><span class="p p-Indicator">,</span><span class="nv">79.98</span><span class="p p-Indicator">,</span><span class="nv">80.15</span><span class="p p-Indicator">,</span><span class="nv">79.77</span><span class="p p-Indicator">,</span><span class="nv">80.30</span><span class="p p-Indicator">,</span><span class="nv">80.18</span><span class="p p-Indicator">,</span><span class="nv">80.25</span><span class="p p-Indicator">,</span><span class="nv">79.88</span><span class="p p-Indicator">,</span><span class="nv">80.02</span> <span class="p p-Indicator">]</span>

<span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="nt">bin_range</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">79.</span><span class="p p-Indicator">,</span> <span class="nv">81.</span><span class="p p-Indicator">]</span>
<span class="c1"># alternatively an array for the bin edges can be specified</span>
<span class="c1">#bin_edges: [79., 79.5, 80, 80.5, 81.]</span>

<span class="nt">model_density_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">def normal_distribution(x, mu=80., sigma=1.):</span>
    <span class="no">return np.exp(-0.5*((x - mu)/sigma)** 2)/np.sqrt(2.*np.pi*sigma** 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">mFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg2logL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'Density</span> <span class="pre">=</span> <span class="pre">f(x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to directly fit a user-defined cost funtion</p>
<p>This is the simplest fit possible with the class mnFit. If no data is
specified (data=None), a user-supplied cost function (ufcn) is minimized 
and an estimation of the parameter uncertainties performed, assuming
the cost function is a negative log-likelihood function (nlL of 2nLL).</p>
<p>In case data is provided, the user function <cite>ufcn(data, *par)</cite> is 
interpreted as a parameter-dependent probability density function, and
the parameters are determined in an unbinned log-likelihood approach.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>ufcn: user-defined cost function or pdf to be minimized;</p>
<ul>
<li><p>ufcn(*par): the uncertainty estimation relies on this being a 
negative log-likelihood function (‘nlL’); in this case, no data
is to be provided, i.e. <cite>data=None</cite>.</p></li>
<li><p>ufcn(x, *par): a probability density of the data <cite>x</cite> depending on
the set of parameters <cite>par</cite>.</p></li>
</ul>
</li>
<li><p>data, optional, array of floats: optional input data</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: array-like, initial guess of parameters</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>constraints: (nested) list(s) [name or id, value, error]</p></li>
<li><p>limits: (nested) list(s) [name or id, min, max]</p></li>
<li><p>neg2logL: use 2 * nlL (corresponding to a least-squares-type cost)</p></li>
<li><p>plot: show data and model if True</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_cor: plot likelihood profiles and confidence contours of parameters</p></li>
<li><p>showplots: show plots on screen (can also be done by calling script)</p></li>
<li><p>quiet: controls verbose output</p></li>
<li><p>bool: for experts only, return instance of class mnFit to 
give access to data members and methods</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">mnFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Fit an arbitrary function f(x, *par) to data</strong>  
with independent and/or correlated absolute and/or relative uncertainties</p>
<p>This implementation depends on and heavily uses features of 
the minimizer and uncertainty-estimator <strong>iminuit</strong>.</p>
<p>Public Data member</p>
<ul class="simple">
<li><p>fit_type: ‘xy’ (default), ‘hist’, ‘user’ or ‘ml’, controls type of fit</p></li>
</ul>
<p>Public methods:</p>
<ul class="simple">
<li><p>init_data():        generic wrapper for init_*Data() methods</p></li>
<li><p>init_fit():         generic wrapper for init_*Fit() methods</p></li>
<li><p>setOptions():       generic wrapper for set_*Options() methods</p></li>
<li><p>do_fit():           generic wrapper for do_*Fit() methods</p></li>
<li><p>plotModel():        plot model function and data</p></li>
<li><p>plotContours():     plot profile likelihoods and confidence contours</p></li>
<li><p>getResult():        access to final fit results</p></li>
<li><p>getFunctionError(): uncertainty of model at point(s) x for parameters p</p></li>
<li><p>plot_Profile():     plot profile Likelihood for parameter</p></li>
<li><p>plot_clContour():   plot confidence level contour for pair of parameters</p></li>
<li><p>plot_nsigContour(): plot n-sigma contours for pair of parameters</p></li>
<li><p>getProfile():       return profile likelihood of parameter pnam</p></li>
<li><p>getContour():       return contour points of pair of parameters</p></li>
</ul>
<p>Sub-Classes:</p>
<ul class="simple">
<li><p>xyDataContainer:    Data and uncertainties for x-y data</p></li>
<li><p>histDataContainer:  Container for histogram data</p></li>
<li><p>mlDataContainter:   Container for general (indexed) data</p></li>
<li><p>xLSqCost:           Extended chi^2 cost function for fits to x-y data</p></li>
<li><p>hCost:              Cost function for (binned) histogram data 
(2*negl. log. Likelihood of Poisson distribution)</p></li>
<li><p>mnCost:             user-supplied cost function or negative log-likelihood 
of user-supplied probability distribution</p></li>
</ul>
<p>Methods:</p>
<ul class="simple">
<li><p>init_xyData():       initialize xy data and uncertainties</p></li>
<li><p>init_hData():        initialize histogram data and uncertainties</p></li>
<li><p>init_mlData():       store data for unbinned likelihood-fit</p></li>
<li><p>init_xyFit():        initialize xy fit: data, model and constraints</p></li>
<li><p>init_hFit():         initialize histogram fit: data, model and constraints</p></li>
<li><p>init_mnFit():        initialize histogram simple minuit fit</p></li>
<li><p>set_xyOptions():     set options for xy Fit</p></li>
<li><p>set_hOptions():      set options for histogram Fit</p></li>
<li><p>set_mnOptions():     set options for simple minuit fit with external cost function</p></li>
<li><p>do_xyFit():          perform xy fit</p></li>
<li><p>do_hFit():           perform histogram fit</p></li>
<li><p>do_mnFit():          simple minuit fit with external, user-defined cost function</p></li>
</ul>
<p>Data members:</p>
<ul class="simple">
<li><p>iminuit_version     version of iminuit</p></li>
<li><p>options, dict:      list of options</p></li>
<li><p>ParameterNames:     names of parameters (as specified in model function)</p></li>
<li><p>nconstraints        number of constrained parameters</p></li>
<li><p>nfixed              number of fixed parameters</p></li>
<li><p>freeParNams:        names of free parameters</p></li>
<li><p>GoF:                goodness-of-fit, i.e. chi2 at best-fit point</p></li>
<li><p>NDoF:               number of degrees of freedom</p></li>
<li><p>ParameterValues:    parameter values at best-fit point</p></li>
<li><p>MigradErrors:       symmetric uncertainties</p></li>
<li><p>CovarianceMatrix:   covariance matrix</p></li>
<li><p>CorrelationMatrix:  correlation matrix</p></li>
<li><p>OneSigInterval:     one-sigma (68% CL) ranges of parameter values from MINOS  - ResultDictionary:   dictionary wih summary of fit results</p></li>
<li><p>for xyFit:</p>
<ul>
<li><p>covx:     covariance matrix of x-data</p></li>
<li><p>covy:     covariance matrix of y-data</p></li>
<li><p>cov:      combined covariance matrix, including projected x-uncertainties</p></li>
</ul>
</li>
</ul>
<p>Instances of (sub-)classes:</p>
<ul class="simple">
<li><p>minuit.*: methods and members of Minuit object</p></li>
<li><p>data.*:   methods and members of data sub-class, generic</p></li>
<li><p>costf.*:  methods and members of cost sub-class, generic</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.CL2Chi2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CL2Chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CL</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.CL2Chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate DeltaChi2 from confidence level CL for 2-dim contours</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.Chi22CL">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Chi22CL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dc2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.Chi22CL" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate confidence level CL from DeltaChi2 for 2-dim contours</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.chi2prb">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2prb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndof</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.chi2prb" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate chi2-probability from chi2 and degrees of freedom</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.do_fit">
<span class="sig-name descname"><span class="pre">do_fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.do_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>perform all necessary steps of fit sequence</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.getContour">
<span class="sig-name descname"><span class="pre">getContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnam1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnam2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.getContour" title="Permalink to this definition">¶</a></dt>
<dd><p>return profile likelihood contour of parameters pnam1 and pnam2</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>1st parameter name</p></li>
<li><p>2nd parameter name</p></li>
<li><p>confidence level</p></li>
<li><p>number of points</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>array of float (npoints * 2) contour points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.getFunctionError">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">getFunctionError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixedPars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.getFunctionError" title="Permalink to this definition">¶</a></dt>
<dd><p>determine error of model at x</p>
<dl class="simple">
<dt>Formula: </dt><dd><p>Delta(x) = sqrt( sum_i,j (df/dp_i(x) df/dp_j(x) Vp_i,j) )</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>x: scalar or np-array of x values</p></li>
<li><p>model: model function</p></li>
<li><p>pvlas: parameter values</p></li>
<li><p>covp: covariance matrix of parameters</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>model uncertainty, same length as x</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.getProfile">
<span class="sig-name descname"><span class="pre">getProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.getProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>return profile likelihood of parameter pnam</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>parameter name</p></li>
<li><p>scan range in sigma, are tuple with lower and upper value</p></li>
<li><p>number of points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.getResult">
<span class="sig-name descname"><span class="pre">getResult</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.getResult" title="Permalink to this definition">¶</a></dt>
<dd><p>return result dictionary</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.hCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_GaussApprox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.hCost" title="Permalink to this definition">¶</a></dt>
<dd><p>Cost function for binned data</p>
<p>The __call__ method of this class is called by iminuit.</p>
<p>The default cost function to minimoze is twice the negative 
log-likelihood of the Poisson distribution generalized to 
continuous observations x by replacing k! by the gamma function:</p>
<div class="math notranslate nohighlight">
\[cost(x;\lambda) = 2 \lambda (\lambda - x*\ln(\lambda) + \ln\Gamma(x+1.))\]</div>
<p>Alternatively, the Gaussian approximation is available:</p>
<div class="math notranslate nohighlight">
\[cost(x;\lambda) = (x - \lambda)^2 / \lambda + \ln(\lambda)\]</div>
<p>The implementation also permits to shift the observation x by an
offset to take into account corrections to the number of observed
bin entries (e.g. due to background or efficiency corrections):
x -&gt; x-deltaMu with deltaMu = mu - lambda, where mu is the mean
of the shifted Poisson or Gauß distribution.</p>
<p>The number of bin entries predicted by the model density is calculated
by an approximate integral over the respective bin ranges using the
Simpson rule.</p>
<p>To judge the level of agreement of model density and histogram data, 
a “goodness-of-fit” (<em>gof</em>) value is calulated as the likelihood-ratio of
the model w.r.t. the data and the so-called “saturated model” describing 
the data perfectly, i.e.  <span class="math notranslate nohighlight">\(cost_{sat}(x) = cost(x; \lambda=x)\)</span>.
If the bin entries are sufficiently large, <em>gof</em> converges to the standard 
<em>chi2</em> value.</p>
<p>Input:</p>
<ul class="simple">
<li><p>outer: pointer to instance of calling class</p></li>
<li><p>model: model function f(x, *par)</p></li>
<li><p>use_GaussApprox, bool: use Gaussian approximation</p></li>
<li><p>density, bool: fit a normalised density; if False, an overall
normalisation must be provided in the model function</p></li>
</ul>
<p>Data members:</p>
<ul class="simple">
<li><p>ndof: degrees of freedom</p></li>
<li><p>nconstraints: number of parameter constraints</p></li>
<li><p>gof: goodness-of-fit as likelihood ratio w.r.t. the ‘saturated model’</p></li>
</ul>
<p>External references:</p>
<ul class="simple">
<li><p>model(x, *par): the model function</p></li>
<li><p>data: pointer to instance of class histData</p></li>
<li><p>data.model_values: bin entries calculated by the best-fit model</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.hCost.integral_overBins">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integral_overBins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ledges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.hCost.integral_overBins" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate approx. integral of model over bins using Simpson’s rule</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.hCost.n2lLGauss">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n2lLGauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.hCost.n2lLGauss" title="Permalink to this definition">¶</a></dt>
<dd><p>negative log-likelihood of Gaussian approximation
Pois(x, lam) simeq Gauss(x, mu=lam, sigma^2=lam)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.hCost.n2lLPoisson">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n2lLPoisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.hCost.n2lLPoisson" title="Permalink to this definition">¶</a></dt>
<dd><p>neg. logarithm of Poisson distribution for real-valued x</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.hCost.n2lLsPoisson">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n2lLsPoisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.hCost.n2lLsPoisson" title="Permalink to this definition">¶</a></dt>
<dd><p>2* neg. logarithm of generalized Poisson distribution: 
shifted to new mean mu for real-valued xk        
for lam=mu, the standard Poisson distribution is recovered
lam=sigma*2 is the variance of the shifted Poisson distribution.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.histDataContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">histDataContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_contents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DeltaMu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.histDataContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for Histogram data</p>
<p>Data Members:</p>
<ul class="simple">
<li><p>contents, array of floats: bin contents</p></li>
<li><p>edges, array of floats: bin edges (nbins+1 values)</p></li>
</ul>
<p>calculated from input:</p>
<ul class="simple">
<li><p>nbins: number of bins</p></li>
<li><p>lefts: left edges</p></li>
<li><p>rights: right edges</p></li>
<li><p>centers: bin centers</p></li>
<li><p>widths: bin widths</p></li>
<li><p>Ntot: total number of entries, used to normalize probatility density</p></li>
</ul>
<p>available after completion of fit:</p>
<ul class="simple">
<li><p>model_values: bin contents from best-fit model</p></li>
</ul>
<p>Methods:</p>
<ul class="simple">
<li><p>plot(): return figure with histogram of data and uncertainties</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.histDataContainer.Poisson_CI">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Poisson_CI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.histDataContainer.Poisson_CI" title="Permalink to this definition">¶</a></dt>
<dd><p>determine one-sigma Confidence Interval around the 
mean lambda of a Poisson distribution, Poiss(x, lambda).</p>
<p>The method is based on delta-log-Likelihood (dlL) 
of the Poission likelihood</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>lam: mean of Poission distribution</p></li>
<li><p>cl: desired confidence level</p></li>
<li><p>sigma: alternatively specify an n-sigma interval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.histDataContainer.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'histData</span> <span class="pre">and</span> <span class="pre">Model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.5,</span> <span class="pre">6.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Binned</span> <span class="pre">data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.histDataContainer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>return figure with histogram data and uncertainties</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.indexedCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indexedCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_neg2logL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.indexedCost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Custom e_x_tended Least-SQuares cost function with 
dynamically updated covariance matrix and -2log(L) 
correction term for parameter-dependent uncertainties.</p>
<p>The default cost function is twice the negative logarithm 
of the likelihood of a Gaussian distribution for data points 
<span class="math notranslate nohighlight">\((x, y)\)</span> with a model function <span class="math notranslate nohighlight">\(y=f(x, *p)\)</span> depending
on a set of parameters <span class="math notranslate nohighlight">\(*p\)</span> and a possibly parameter-dependent
covariance matrix <span class="math notranslate nohighlight">\(V(x, f(x, *p))\)</span> of the x and y data:</p>
<div class="math notranslate nohighlight">
\[-2\ln {\cal L} = \chi^2(x, V^{-1}, x(*p) \,) 
+ \ln(\, \det( V(x, x(*p) ) \,)\]</div>
<p>In the absence of parameter-dependent components of the covariance
matrix, the last term is omitted and the cost function is identical
to the classical <span class="math notranslate nohighlight">\(\chi^2\)</span>. 
For the evaluation of the cost function an efficient approach based
on the “Cholesky decomposition” of the covariance matrix in 
a product of a triangular matrix and its transposed is used:</p>
<div class="math notranslate nohighlight">
\[V = L L^T.    \]</div>
<p>The value of the cost function</p>
<div class="math notranslate nohighlight">
\[\chi^2 = {r}\cdot (V^{-1}{r}) ~~with~~ r = x - x(*p)\]</div>
<p>is then calculated by solving the linear equation</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[V X = r, ~i.e.~ X=V^{-1} r ~and~ \chi^2= r \cdot X   \]</div>
<p>with the linear-equation solver <em>scipy.linalg.cho_solve(L,x)</em>
for Cholesky-decomposed matrices, thus avoiding the costy 
calculation of the inverse matrix.</p>
<p>The determinant, if needed, is efficiently calculated by taking 
the product of the diagonal elements of the matrix L,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\det(V) = 2 \, \prod L_{i,i}\]</div>
<p>Input:</p>
<ul class="simple">
<li><p>outer: pointer to instance of calling class</p></li>
<li><p>model: model function calulating the data x(*par)</p></li>
<li><p>use_neg2logL: use full -2log(L) instead of chi2 if True</p></li>
</ul>
<p>__call__ method of this class is called by iminuit</p>
<p>Data members:</p>
<ul class="simple">
<li><p>ndof: degrees of freedom</p></li>
<li><p>nconstraints: number of parameter constraints</p></li>
<li><p>gof: chi2-value (goodness of fit)</p></li>
<li><p>use_neg2logL: usage of full 2*neg Log Likelihood</p></li>
<li><p>quiet: no printout if True</p></li>
</ul>
<p>Methods:</p>
<ul class="simple">
<li><p>model(x, *par)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_hData">
<span class="sig-name descname"><span class="pre">init_hData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_contents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DeltaMu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_hData" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize histogram data object</p>
<p>Args:
- bin_contents: array of floats
- bin_edges: array of length len(bin_contents)*1
- DeltaMu: shift in mean (Delta mu) versus lambda 
of Poisson distribution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_hFit">
<span class="sig-name descname"><span class="pre">init_hFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_hFit" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize fit object</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model: model density function f(x; *par)</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: np-array of floats, initial parameter values</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>constraints: (nested) list(s): [parameter name, value, uncertainty] 
or [parameter index, value, uncertainty]</p></li>
<li><p>fix parameter(s) in fit: list of parameter names or indices</p></li>
<li><p>limits: (nested) list(s): [parameter name, min, max] 
or [parameter index, min, max]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_mlData">
<span class="sig-name descname"><span class="pre">init_mlData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_mlData" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize data object</p>
<p>Args:
- x, array of floats</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_mnFit">
<span class="sig-name descname"><span class="pre">init_mnFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userFunction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_mnFit" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize fit object for simple minuit fit with
* with user-supplied cost function or
* a probability density function for an unbinned neg. log-L fit</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>costFunction: cost function or pdf</p></li>
<li><p>p0: np-array of floats, initial parameter values</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>parameter constraints: (nested) list(s): [parameter name, value, uncertainty]</p></li>
<li><p>fix parameter(s) in fit: list of parameter names or indices</p></li>
<li><p>limits: (nested) list(s): [parameter name, min, max] or
[parameter index, min, max]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_xData">
<span class="sig-name descname"><span class="pre">init_xData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_xData" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize data object</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>x:      data values</p></li>
<li><p>s:      independent uncertainties x</p></li>
<li><p>srel:   independent relative uncertainties x</p></li>
<li><p>cabs:   correlated abolute uncertainties x</p></li>
<li><p>crel:   correlated relative uncertainties x</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_xFit">
<span class="sig-name descname"><span class="pre">init_xFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_xFit" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize fit object</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model: model function f(x; *par)</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: np-array of floats, initial parameter values</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>constraints: (nested) list(s): [parameter name, value, uncertainty] 
or [parameter index, value, uncertainty]</p></li>
<li><p>limits: (nested) list(s): [parameter name, min, max] 
or [parameter index, min, max]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_xyData">
<span class="sig-name descname"><span class="pre">init_xyData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erelx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erely</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabsx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crelx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabsy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crely</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_xyData" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize data object</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>x:       abscissa of data points (“x values”)</p></li>
<li><p>y:       ordinate of data points (“y values”)</p></li>
<li><p>ex:      independent uncertainties x</p></li>
<li><p>ey:      independent uncertainties y</p></li>
<li><p>erelx:   independent relative uncertainties x</p></li>
<li><p>erely:   independent relative uncertainties y</p></li>
<li><p>cabsx:   correlated abolute uncertainties x</p></li>
<li><p>crelx:   correlated relative uncertainties x</p></li>
<li><p>cabsy:   correlated absolute uncertainties y</p></li>
<li><p>crely:   correlated relative uncertainties y</p></li>
<li><p>quiet:   no informative printout if True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.init_xyFit">
<span class="sig-name descname"><span class="pre">init_xyFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.init_xyFit" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize fit object</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model: model function f(x; *par)</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: np-array of floats, initial parameter values</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>constraints: (nested) list(s): [parameter name, value, uncertainty] 
or [parameter index, value, uncertainty]</p></li>
<li><p>limits: (nested) list(s): [parameter name, min, max] 
or [parameter index, min, max]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.mlDataContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mlDataContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.mlDataContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for general (indexed) data</p>
<p>Data Members:</p>
<ul class="simple">
<li><p>x, array of floats: data</p></li>
</ul>
<p>Methods:</p>
<p>-plot(): return figure with representation of data</p>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.mlDataContainer.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indexed</span> <span class="pre">data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.5,</span> <span class="pre">6.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.mlDataContainer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>return figure with histogram data and uncertainties</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.mnCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mnCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">userFunction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.mnCost" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for simple minuit fit with user-supplied cost function.</p>
<p>The __call__ method of this class is called by iminuit.</p>
<p>Args:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>userCostFunction: user-supplied cost function for minuit;</dt><dd><p>must be a negative log-likelihood</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.mnCost.nlLcost">
<span class="sig-name descname"><span class="pre">nlLcost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.mnCost.nlLcost" title="Permalink to this definition">¶</a></dt>
<dd><p>negative log likelihood of data and user-defined PDF and</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.plotContours">
<span class="sig-name descname"><span class="pre">plotContours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Profiles</span> <span class="pre">and</span> <span class="pre">Contours'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.plotContours" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot grid of profile curves and one- and two-sigma
contour lines from iminuit object</p>
<dl class="simple">
<dt>Arg: </dt><dd><ul class="simple">
<li><p>iminuitObject</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>matplotlib figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.plotModel">
<span class="sig-name descname"><span class="pre">plotModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y</span> <span class="pre">=</span> <span class="pre">f(x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.plotModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot model function and data</p>
<p>Uses iminuitObject, cost Function (and data object)</p>
<dl class="simple">
<dt>Args: </dt><dd><ul class="simple">
<li><p>list of str: axis labels</p></li>
<li><p>str: legend for data</p></li>
<li><p>str: legend for model</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>matplotlib figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.plot_Profile">
<span class="sig-name descname"><span class="pre">plot_Profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.plot_Profile" title="Permalink to this definition">¶</a></dt>
<dd><p>plot profile likelihood of parameter pnam</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>parameter name</p></li>
<li><p>scan range in sigma, are tuple with lower and upper value</p></li>
<li><p>number of points</p></li>
</ul>
</dd>
<dt>Returns: </dt><dd><ul class="simple">
<li><p>matplotlib figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.plot_clContour">
<span class="sig-name descname"><span class="pre">plot_clContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnam1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnam2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.plot_clContour" title="Permalink to this definition">¶</a></dt>
<dd><p>plot a contour of parameters pnam1 and pnam2
with confidence level(s) cl</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.plot_nsigContour">
<span class="sig-name descname"><span class="pre">plot_nsigContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnam1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnam2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.plot_nsigContour" title="Permalink to this definition">¶</a></dt>
<dd><p>plot nsig contours of parameters pnam1 and pnam2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.setPlotOptions">
<span class="sig-name descname"><span class="pre">setPlotOptions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.setPlotOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set options for nicer plotting</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.set_hOptions">
<span class="sig-name descname"><span class="pre">set_hOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_minos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_GaussApprox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.set_hOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define mnFit options</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>run minos else don*t run minos</p></li>
<li><p>use Gaussian Approximation of Poisson distribution</p></li>
<li><p>don*t provide printout else verbose printout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.set_mnOptions">
<span class="sig-name descname"><span class="pre">set_mnOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_minos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg2logL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.set_mnOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define options for minuit fit with user cost function</p>
<p>Args:</p>
<ul class="simple">
<li><p>run_minos: run minos profile likelihood scan</p></li>
<li><p>neg2logL: cost function is -2 negLogL</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.set_xOptions">
<span class="sig-name descname"><span class="pre">set_xOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_refers_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_minos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_negLogL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.set_xOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define options for indexed fit</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>rel. errors refer to model else data</p></li>
<li><p>run minos else don*t run minos</p></li>
<li><p>use full neg2logL</p></li>
<li><p>don*t provide printout else verbose printout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.set_xyOptions">
<span class="sig-name descname"><span class="pre">set_xyOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_refers_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_minos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_negLogL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.set_xyOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define options for xy fit</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>rel. errors refer to model else data</p></li>
<li><p>run minos else don*t run minos</p></li>
<li><p>use full neg2logL</p></li>
<li><p>don*t provide printout else verbose printout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xDataContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xDataContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xDataContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle data and uncertainties and  
build covariance matrices from components</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>outer:   pointer to instance of calling object</p></li>
<li><p>x:       abscissa of data points (“x values”)</p></li>
<li><p>e:       independent uncertainties</p></li>
<li><p>erel:   independent relative uncertainties x</p></li>
<li><p>cabs:   correlated abolute uncertainties x</p></li>
<li><p>crel:   correlated relative uncertainties x</p></li>
<li><p>quiet:   no informative printout if True</p></li>
</ul>
</dd>
<dt>Public methods:</dt><dd><ul class="simple">
<li><p>init_dynamicErrors():</p></li>
<li><p>get_Cov(): final covariance matrix (incl. proj. x)</p></li>
<li><p>get_iCov(): inverse covariance matrix</p></li>
<li><p>plot(): provide a figure with representation of data</p></li>
</ul>
</dd>
<dt>Data members:  </dt><dd><ul class="simple">
<li><p>copy of all input arguments</p></li>
<li><p>cov: covariance matrix</p></li>
<li><p>iCov: inverse of covariance matrix</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xDataContainer.get_Cov">
<span class="sig-name descname"><span class="pre">get_Cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xDataContainer.get_Cov" title="Permalink to this definition">¶</a></dt>
<dd><p>return covariance matrix of data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xDataContainer.get_iCov">
<span class="sig-name descname"><span class="pre">get_iCov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xDataContainer.get_iCov" title="Permalink to this definition">¶</a></dt>
<dd><p>return inverse of covariance matrix, as used in cost function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xDataContainer.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Data</span> <span class="pre">and</span> <span class="pre">Model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.5,</span> <span class="pre">6.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xDataContainer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>return figure with data and uncertainties</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xLSqCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xLSqCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_neg2logL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xLSqCost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Custom e_x_tended Least-SQuares cost function with 
dynamically updated covariance matrix and -2log(L) 
correction term for parameter-dependent uncertainties.</p>
<p>The default cost function is twice the negative logarithm 
of the likelihood of a Gaussian distribution for data points 
<span class="math notranslate nohighlight">\((x, y)\)</span> with a model function <span class="math notranslate nohighlight">\(y=f(x, *p)\)</span> depending
on a set of parameters <span class="math notranslate nohighlight">\(*p\)</span> and a possibly parameter-dependent
covariance matrix <span class="math notranslate nohighlight">\(V(x, f(x, *p))\)</span> of the x and y data:</p>
<div class="math notranslate nohighlight">
\[-2\ln {\cal L} = \chi^2(y, V^{-1}, f(x, *p) \,) 
+ \ln(\, \det( V(x, f(x, *p) ) \,)\]</div>
<p>In the absence of parameter-dependent components of the covariance
matrix, the last term is omitted and the cost function is identical
to the classical <span class="math notranslate nohighlight">\(\chi^2\)</span>. 
For the evaluation of the cost function an efficient approach based
on the “Cholesky decomposition” of the covariance matrix in 
a product of a triangular matrix and its transposed is used:</p>
<div class="math notranslate nohighlight">
\[V = L L^T.    \]</div>
<p>The value of the cost function</p>
<div class="math notranslate nohighlight">
\[\chi^2 = {r}\cdot (V^{-1}{r}) ~~with~~ r = y - f(x,*p)\]</div>
<p>is then calculated by solving the linear equation</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[V X = r, ~i.e.~ X=V^{-1} r ~and~ \chi^2= r \cdot X   \]</div>
<p>with the linear-equation solver <em>scipy.linalg.cho_solve(L,x)</em>
for Cholesky-decomposed matrices, thus avoiding the costy 
calculation of the inverse matrix.</p>
<p>The determinant, if needed, is efficiently calculated by taking 
the product of the diagonal elements of the matrix L,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\det(V) = 2 \, \prod L_{i,i}\]</div>
<p>Input:</p>
<ul class="simple">
<li><p>outer: pointer to instance of calling class</p></li>
<li><p>model: model function f(x, *par)</p></li>
<li><p>use_neg2logL: use full -2log(L) instead of chi2 if True</p></li>
</ul>
<p>__call__ method of this class is called by iminuit</p>
<p>Data members:</p>
<ul class="simple">
<li><p>ndof: degrees of freedom</p></li>
<li><p>nconstraints: number of parameter constraints</p></li>
<li><p>gof: chi2-value (goodness of fit)</p></li>
<li><p>use_neg2logL: usage of full 2*neg Log Likelihood</p></li>
<li><p>quiet: no printout if True</p></li>
</ul>
<p>Methods:</p>
<ul class="simple">
<li><p>model(x, *par)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyDataContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erelx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erely</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabsx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crelx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cabsy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crely</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle data and uncertainties and  
build covariance matrices from components</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>outer:   pointer to instance of calling object</p></li>
<li><p>x:       abscissa of data points (“x values”)</p></li>
<li><p>y:       ordinate of data points (“y values”)</p></li>
<li><p>ex:      independent uncertainties x</p></li>
<li><p>ey:      independent uncertainties y</p></li>
<li><p>erelx:   independent relative uncertainties x</p></li>
<li><p>erely:   independent relative uncertainties y</p></li>
<li><p>cabsx:   correlated abolute uncertainties x</p></li>
<li><p>crelx:   correlated relative uncertainties x</p></li>
<li><p>cabsy:   correlated absolute uncertainties y</p></li>
<li><p>crely:   correlated relative uncertainties y</p></li>
<li><p>quiet:   no informative printout if True</p></li>
</ul>
</dd>
<dt>Public methods:</dt><dd><ul class="simple">
<li><p>init_dynamicErrors():</p></li>
<li><p>get_Cov(): final covariance matrix (incl. proj. x)</p></li>
<li><p>get_xCov(): covariance of x-values</p></li>
<li><p>get_yCov(): covariance of y-values</p></li>
<li><p>get_iCov(): inverse covariance matrix</p></li>
<li><p>plot(): provide a figure with representation of data</p></li>
</ul>
</dd>
<dt>Data members:  </dt><dd><ul class="simple">
<li><p>copy of all input arguments</p></li>
<li><p>covx: covariance matrix of x</p></li>
<li><p>covy: covariance matrix of y uncertainties</p></li>
<li><p>cov: full covariance matrix incl. projected x</p></li>
<li><p>iCov: inverse of covariance matrix</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer.get_Cov">
<span class="sig-name descname"><span class="pre">get_Cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer.get_Cov" title="Permalink to this definition">¶</a></dt>
<dd><p>return covariance matrix of data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer.get_iCov">
<span class="sig-name descname"><span class="pre">get_iCov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer.get_iCov" title="Permalink to this definition">¶</a></dt>
<dd><p>return inverse of covariance matrix, as used in cost function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer.get_xCov">
<span class="sig-name descname"><span class="pre">get_xCov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer.get_xCov" title="Permalink to this definition">¶</a></dt>
<dd><p>return covariance matrix of x-data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer.get_yCov">
<span class="sig-name descname"><span class="pre">get_yCov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer.get_yCov" title="Permalink to this definition">¶</a></dt>
<dd><p>return covariance matrix of y-data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.mnFit.xyDataContainer.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xyData</span> <span class="pre">and</span> <span class="pre">Model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.5,</span> <span class="pre">6.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.mnFit.xyDataContainer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>return figure with xy data and uncertainties</p>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.round_to_error">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">round_to_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsd_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.round_to_error" title="Permalink to this definition">¶</a></dt>
<dd><p>round float <em>val</em> to same number of significant digits as uncertainty <em>err</em></p>
<dl class="simple">
<dt>Returns:</dt><dd><ul class="simple">
<li><p>int:   number of significant digits for v</p></li>
<li><p>float: val rounded to precision of err</p></li>
<li><p>float: err rounded to precision nsd_e</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.xFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">xFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_negLogL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Index',</span> <span class="pre">'f(*x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.xFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to fit an arbitrary function to data with
independent and/or correlated absolute and/or relative uncertainties 
with class mnFit. Uncertainties are assumed to be desribed by
a multivariate Gaussian distribution, i.e. the covariance matrix of 
the data {x_i} is taken into account in the cost function.</p>
<p>Correlated absolute and/or relative uncertainties of input data 
are specified as floats (if all uncertainties are equal) or as 
numpy-arrays of floats. The concept of independent or common 
uncertainties of (groups) of values is used to construct the 
full covariance matrix from different uncertainty components.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>fitf: model function to fit, arguments (float:x, float: *args)</p></li>
<li><p>x:  np-array of data values</p></li>
<li><p>s: scalar or 1d or 2d np-array with uncertainties</p></li>
<li><p>srel: scalar or np-array; relative uncertainties</p></li>
<li><p>sabscor: scalar or np-array; absolute, correlated error(s)</p></li>
<li><p>srelcor: scalar or np-array; relative, correlated error(s)</p></li>
<li><p>ref_to_model: relative errors w.r.t. model if True</p></li>
<li><p>names: optional names for each input value</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: array-like, initial guess of parameters</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>use_negLogL:  use full -2ln(L)</p></li>
<li><p>constraints: (nested) list(s) [name or id, value, error]</p></li>
<li><p>fix parameter(s) in fit: list of parameter names or indices</p></li>
<li><p>limits: (nested) list(s) [name or id, min, max]</p></li>
<li><p>plot: show data points and model prediction if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model prediction</p></li>
<li><p>plot_residual: plot residuals w.r.t. model instead of model prediction</p></li>
<li><p>showplots: show plots on screen</p></li>
<li><p>quiet: suppress printout</p></li>
<li><p>list of str: axis labels</p></li>
<li><p>str: legend for data</p></li>
<li><p>str: legend for model</p></li>
<li><p>bool: for experts only, return instance of class mnFit to 
give access to data members and methods</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-array of float: parameter values</p></li>
<li><p>2d np-array of float: parameter uncertainties [0]: neg. and [1]: pos.</p></li>
<li><p>np-array: correlation matrix</p></li>
<li><p>float: 2*negLog L, corresponding to chi-square of fit a minimum</p></li>
</ul>
<p>or, optionally, the mnFit instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.xyFit">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">xyFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srelx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srely</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yabscor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yrelcor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixPars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_negLogL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y</span> <span class="pre">=</span> <span class="pre">f(x,</span> <span class="pre">*par)']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.xyFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to fit an arbitrary function fitf(x, *par) 
to data points (x, y) with independent and/or correlated absolute 
and/or relative uncertainites on x- and/or y- values with class mnFit.</p>
<p>Correlated absolute and/or relative uncertainties of input data 
are specified as floats (if all uncertainties are equal) or as 
numpy-arrays of floats. The concept of independent or common 
uncertainties of (groups) of data points is used to construct the 
full covariance matrix from different uncertainty components.
Independent uncertainties enter only in the diagonal, while correlated 
ones contribute to diagonal and off-diagonal elements of the covariance 
matrix. Values of 0. may be specified for data points not affected by a 
certain type of uncertainty. E.g. the array [0., 0., 0.5., 0.5] specifies
uncertainties only affecting the 3rd and 4th data points. Providing lists 
of such arrays permits the construction of arbitrary covariance matrices 
from independent and correlated uncertainties of (groups of) data points.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>fitf: model function to fit, arguments (float:x, float: *args)</p></li>
<li><p>x:  np-array, independent data</p></li>
<li><p>y:  np-array, dependent data</p></li>
<li><p>sx: scalar or 1d or 2d np-array , uncertainties on x data</p></li>
<li><p>sy: scalar or 1d or 2d np-array , uncertainties on x data</p></li>
<li><p>srelx: scalar or np-array, relative uncertainties x</p></li>
<li><p>srely: scalar or np-array, relative uncertainties y</p></li>
<li><p>yabscor: scalar or np-array, absolute, correlated error(s) on y</p></li>
<li><p>yrelcor: scalar or np-array, relative, correlated error(s) on y</p></li>
<li><p>model_kwargs: optional, fit parameters if not from model signature</p></li>
<li><p>p0: array-like, initial guess of parameters</p></li>
<li><p>dp0: array-like, initial guess of parameter uncertainties (optional)</p></li>
<li><p>use_negLogL:  use full -2ln(L)</p></li>
<li><p>constraints: (nested) list(s) [name or id, value, error]</p></li>
<li><p>fix parameter(s) in fit: list of parameter names or indices</p></li>
<li><p>limits: (nested) list(s) [name or id, min, max]</p></li>
<li><p>plot: show data and model if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_residual: plot residuals w.r.t. model instead of model function</p></li>
<li><p>showplots: show plots on screen</p></li>
<li><p>quiet: suppress printout</p></li>
<li><p>list of str: axis labels</p></li>
<li><p>str: legend for data</p></li>
<li><p>str: legend for model</p></li>
<li><p>bool: for experts only, return instance of class mnFit to 
give access to data members and methods</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>np-array of float: parameter values</p></li>
<li><p>2d np-array of float: parameter uncertainties [0]: neg. and [1]: pos.</p></li>
<li><p>np-array: correlation matrix</p></li>
<li><p>float: 2*negLog L, corresponding to chi-square of fit a minimum</p></li>
</ul>
<p>or, optionally, the mnFit instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PhyPraKit.phyFit.xyFit_from_yaml">
<span class="sig-prename descclassname"><span class="pre">PhyPraKit.phyFit.</span></span><span class="sig-name descname"><span class="pre">xyFit_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitObject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#PhyPraKit.phyFit.xyFit_from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform fit with data and model from yaml file</p>
<p>Fit to x-y data with independent and correlated, absolute and relative 
uncertainties in the x and y directions read from dictionary. The
fitting procedure uses phyfit.xyFit().</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>fd: fit input as a dictionary, extracted from a file in yaml format</p></li>
<li><p>plot: show data and model if True</p></li>
<li><p>plot_cor: show profile likelihoods and confidence contours</p></li>
<li><p>plot_band: plot uncertainty band around model function</p></li>
<li><p>plot_residual: plot residuals w.r.t. model instead of model function</p></li>
<li><p>showplots: show plots on screen - switch off if handled by calling process</p></li>
<li><p>quiet: suppress informative printout</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>result dictionary</p></li>
<li><p>optionally: produces result plots</p></li>
</ul>
</dd>
</dl>
<p><strong>fit dictionary format:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str data-set name&gt;</span>

<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str name x-data&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span>  <span class="nv">list of float</span> <span class="p p-Indicator">]</span>   

<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str name y-data&gt;</span>  
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">list of float</span> <span class="p p-Indicator">]</span>

<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt;, [list of floats], or {dictionary/ies}</span>
<span class="nt">y_errors</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt;, [list of floats], or {dictionary/ies}</span>

<span class="nt">model_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str model name&gt;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">&lt;Python code&gt;</span>

<span class="nt">format of uncertainty dictionary</span><span class="p">:</span> 
<span class="p p-Indicator">-</span> <span class="nt">error_value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt; or [list of floats]</span>
<span class="p p-Indicator">-</span> <span class="nt">correlation_coefficient</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0. or 1.</span>
<span class="p p-Indicator">-</span> <span class="nt">relative</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true or false</span>
<span class="l l-Scalar l-Scalar-Plain">relative errors may be spcified as &lt;float&gt;%</span>
</pre></div>
</div>
<p>simple example of <em>yaml</em> input:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">label</span><span class="p">:</span> <span class="s">&#39;Test</span><span class="nv"> </span><span class="s">Data&#39;</span>

<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">0.36</span><span class="p p-Indicator">,</span><span class="nv">0.68</span><span class="p p-Indicator">,</span><span class="nv">0.80</span><span class="p p-Indicator">,</span><span class="nv">1.09</span><span class="p p-Indicator">,</span><span class="nv">1.46</span><span class="p p-Indicator">,</span><span class="nv">1.71</span><span class="p p-Indicator">,</span><span class="nv">1.83</span><span class="p p-Indicator">,</span><span class="nv">2.44</span><span class="p p-Indicator">,</span><span class="nv">2.09</span><span class="p p-Indicator">,</span><span class="nv">3.72</span><span class="p p-Indicator">,</span><span class="nv">4.36</span><span class="p p-Indicator">,</span><span class="nv">4.60</span><span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3%</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="s">&#39;x</span><span class="nv"> </span><span class="s">values&#39;</span>

<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.35</span><span class="p p-Indicator">,</span><span class="nv">0.26</span><span class="p p-Indicator">,</span><span class="nv">0.52</span><span class="p p-Indicator">,</span><span class="nv">0.44</span><span class="p p-Indicator">,</span><span class="nv">0.48</span><span class="p p-Indicator">,</span><span class="nv">0.55</span><span class="p p-Indicator">,</span><span class="nv">0.66</span><span class="p p-Indicator">,</span><span class="nv">0.48</span><span class="p p-Indicator">,</span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nv">0.70</span><span class="p p-Indicator">,</span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nv">0.80</span><span class="p p-Indicator">,</span><span class="nv">0.90</span><span class="p p-Indicator">]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">.06</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.09</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">,</span><span class="nv">.11</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">,</span><span class="nv">.11</span><span class="p p-Indicator">,</span><span class="nv">.12</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">]</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="s">&#39;y</span><span class="nv"> </span><span class="s">values&#39;</span>

<span class="nt">model_label</span><span class="p">:</span> <span class="s">&#39;Parabolic</span><span class="nv"> </span><span class="s">Fit&#39;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">def quadratic_model(x, a=0., b=1., c=0. ):</span>
    <span class="no">return a * x*x + b*x + c</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-test_readColumnData"></span><dl class="simple">
<dt>test_readColumnData.py</dt><dd><p>test data input from text file with module PhyPraKit.readColumnData</p>
</dd>
</dl>
<span class="target" id="module-test_readtxt"></span><dl class="simple">
<dt>test_readtxt.py </dt><dd><p>uses readtxt() to read floating-point column-data in very general 
.txt formats, here the output from PicoTech 8 channel data logger,
with ‘       ‘ separated values, 2 header lines,
german decimal comma and special character ‘^&#64;’</p>
</dd>
</dl>
<span class="target" id="module-test_readPicoScope"></span><dl class="simple">
<dt>test_readPicoSocpe.py </dt><dd><p>read data exported by PicoScope usb-oscilloscope</p>
</dd>
</dl>
<span class="target" id="module-test_labxParser"></span><dl class="simple">
<dt>test_labxParser.py</dt><dd><p>read files in xml-format produced with the Leybold Cassy system  
uses PhyPraPit.labxParser()</p>
</dd>
</dl>
<span class="target" id="module-test_Histogram"></span><dl class="simple">
<dt>test_Historgram.py</dt><dd><p>demonstrate histogram functionality in PhyPraKit</p>
</dd>
</dl>
<span class="target" id="module-test_convolutionFilter"></span><dl>
<dt>test_convolutionFilter.py </dt><dd><p>Read data exported with PicoScope usb-oscilloscpe,
here the accoustic excitation of a steel rod</p>
<p>Demonstrates usage of convolutionFilter for detection
of signal maxima and falling edges</p>
</dd>
</dl>
<span class="target" id="module-test_AutoCorrelation"></span><dl>
<dt>test_AutoCorrelation.py</dt><dd><p>test function <cite>autocorrelate()</cite> in PhyPraKit; 
determines the frequency of a periodic signal from maxima and minima
of the autocorrelation function and performs statistical analysis
of time between peaks/dips</p>
<p>uses <cite>readCSV()</cite>, <cite>autocorrelate()</cite>, <cite>convolutionPeakfinder()</cite> 
and <cite>histstat()</cite> from PhyPraKit</p>
</dd>
</dl>
<span class="target" id="module-test_Fourier"></span><dl>
<dt>test_Fourier.py </dt><dd><p>Read data exported with PicoScope usb-oscilloscpe,
here the accoustic excitation of a steel rod</p>
<p>Demonstraion of a Fourier transformation of the signal</p>
</dd>
</dl>
<span class="target" id="module-test_propagatedError"></span><dl class="simple">
<dt>test_propagatedError.py</dt><dd><p>Beispiel: Numerische Fehlerfortpflanzung mit PhyPraKit.prpagatedError()
Illustriert auch die Verwendung der Rundung auf die Genauigkeit der
Unsicherheit.</p>
</dd>
</dl>
<span class="target" id="module-test_odFit"></span><dl class="simple">
<dt>test_odFit</dt><dd><p>test fitting an arbitrary fucntion with scipy odr, 
with uncertainties in x and y</p>
</dd>
</dl>
<span class="target" id="module-test_xyFit"></span><dl>
<dt>test_xyFit.py</dt><dd><p>Fitting example for x-y data with iminiut</p>
<p>Uses function PhyPraKit.xyFit, which in turn uses mnFit from phyFit</p>
<p>This is a rather complete example showing a fit to
data with independent and correlated, absolute and 
relative uncertainties in the x and y directions.</p>
</dd>
</dl>
<span class="target" id="module-test_xFit"></span><dl class="simple">
<dt>test_xFit.py</dt><dd><p>fit to indexed data x_i with iminiut</p>
</dd>
</dl>
<span class="target" id="module-test_k2Fit"></span><dl class="simple">
<dt>test_k2Fit</dt><dd><dl class="simple">
<dt>Illustrate fitting of an arbitrary function with kafe2   </dt><dd><p>This example illustrates the special features of kafe2:
- correlated errors for x and y data  
- relative errors with reference to model
- profile likelihood method to evaluate asymmetric errors
- plotting of profile likeliood and confidence contours</p>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="module-test_simplek2Fit"></span><p>test_simplek2Fit</p>
<blockquote>
<div><p>test fitting simple line with kafe2, without any errors given</p>
</div></blockquote>
<span class="target" id="module-test_k2hFit"></span><dl class="simple">
<dt>test_k2hFit</dt><dd><p>Illustrate fitting a density to histogram data with kafe2</p>
</dd>
</dl>
<span class="target" id="module-test_generateData"></span><dl class="simple">
<dt>test_generateData</dt><dd><p>test generation of simulated data
this simulates a measurement with given x-values with uncertainties;
random deviations are then added to arrive at the true values, from
which the true y-values are then calculated according to a model
function. In the last step, these true y-values are smeared
by adding random deviations to obtain a sample of measured values</p>
</dd>
</dl>
<span class="target" id="module-toyMC_Fit"></span><dl>
<dt>toyMC_Fit.py</dt><dd><p>run a large number of fits on toyMC data
to check for biases and chi2-probability distribution</p>
<p>This rather complete example uses eight different kinds of uncertainties, 
namely independent and correlated, absolute and relative ones  
in the x and y directions.</p>
</dd>
</dl>
<span class="target" id="module-Beispiel_MultiFit"></span><dl class="simple">
<dt>Beispiel_MultiFit.py   </dt><dd><dl class="simple">
<dt>general example for fitting multiple distributions with kafe2</dt><dd><ul class="simple">
<li><p>define models</p></li>
<li><p>set up data objects</p></li>
<li><p>set up fit objects</p></li>
<li><p>perform fit</p></li>
<li><p>show and save output</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="module-Beispiel_Diodenkennlinie"></span><dl class="simple">
<dt>Beispiel_Diodenkennlinie.py</dt><dd><p>Messung einer Strom-Spannungskennlinie und Anpassung der Schockley-Gleichung.</p>
<ul class="simple">
<li><p>Konstruktion der Kovarianzmatrix für reale Messinstrumente mit 
Signalrauschen, Anzeigeunsicherheiten und korrelierten, realtiven 
Kalibratsionsunsicherheiten für die Strom- und Spannungsmessung.</p></li>
<li><p>Ausführen der Anpassung der Shockley-Gleichung mit <em>k2Fit</em> oder <em>mFit</em> 
aus dem Paket <em>PhyPraKit</em>. Wichtig: die Modellfunktion ist nicht 
nach oben beschränkt, sondern divergiert sehr schnell. Daher muss der 
verwendete numerische Optimierer Parameterlimits unterstützen.</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-Beispiel_Drehpendel"></span><dl class="simple">
<dt>Beispiel_Drehpendel.py  </dt><dd><p>Auswertung der Daten aus einer im CASSY labx-Format gespeicherten Datei
am Beispiel des Drehpendels</p>
<ul class="simple">
<li><p>Einlesen der Daten im .labx-Format</p></li>
<li><p>Säubern der Daten durch verschiedene Filterfunktionen:
- offset-Korrektur
- Glättung durch gleitenden Mittelwert
- Zusammenfassung benachberter Daten durch Mittelung</p></li>
<li><p>Fourier-Transformation (einfach und fft)</p></li>
<li><p>Suche nach Extrema (<cite>peaks</cite> und <cite>dips</cite>)</p></li>
<li><p>Anpassung von Funkionen an Einhüllende der Maxima und Minima</p></li>
<li><p>Interpolation durch Spline-Funktionen</p></li>
<li><p>numerische Ableitung und Ableitung der Splines</p></li>
<li><p>Phasenraum-Darstellung (aufgezeichnete Wellenfunktion
gegen deren Ableitung nach der Zeit)</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-Beispiel_Hysterese"></span><dl class="simple">
<dt>Beispiel_Hysterese.py </dt><dd><p>Auswertung der Daten aus einer mit PicoScope erstellten Datei
im txt-Format am Beispiel des Hystereseversuchs</p>
<ul class="simple">
<li><p>Einlesen der Daten aus PicoScope-Datei vom Typ .txt oder .csv</p></li>
<li><p>Darstellung  Kanal_a vs. Kanal_b</p></li>
<li><p>Auftrennung in zwei Zweige für steigenden bzw. abnehmenden Strom</p></li>
<li><p>Interpolation durch kubische Splines</p></li>
<li><p>Integration der Spline-Funktionen</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-Beispiel_Wellenform"></span><dl class="simple">
<dt>Beispiel_Wellenform.py </dt><dd><p>Einlesen von mit PicoScope erstellten Dateien am Beispiel
der akustischen Anregung eines Stabes</p>
<ul class="simple">
<li><p>Fourier-Analyse des Signals</p></li>
<li><p>Bestimmung der Resonanzfrequenz mittels Autokorrelation</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-Beispiel_GeomOptik"></span><dl class="simple">
<dt>Beispiel_GeomOptik.py </dt><dd><dl class="simple">
<dt>Parameter transformation in Geometrical Optics:</dt><dd><ul class="simple">
<li><p>determine f1, f2 and d of a two-lense system
from system focal widhts f and postions h1 and h2 of princpal planes</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="module-Beispiel_GammaSpektroskopie"></span><dl class="simple">
<dt>Beispiel_GammaSpektroskopie.py  </dt><dd><p>Darstellung der Daten aus einer im CASSY labx-Format gespeicherten Datei
am Beispiel der Gamma-Spektroskopie</p>
<ul class="simple">
<li><p>Einlesen der Daten im .labx-Format</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-run_phyFit"></span><p><strong>run_phyFit.py</strong> [options] &lt;input file name&gt;</p>
<p>Perform fit with data and model from yaml file</p>
<p>Uses functions xyFit and hFit from PhyPraKit.phyFit</p>
<p>This code performs fits</p>
<blockquote>
<div><ul class="simple">
<li><p>to x-y data with independent and correlated, absolute 
and relative uncertainties in the x and y directions</p></li>
<li><p>and to histogram data with a binned likelihood fit.</p></li>
</ul>
</div></blockquote>
<p>usage:</p>
<blockquote>
<div><p>./run_phyFit.py [options] &lt;input file name&gt;</p>
<p>./run_phyFit.py –help for help</p>
</div></blockquote>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li><p>input file in yaml format</p></li>
</ul>
</div></blockquote>
<p>output:</p>
<blockquote>
<div><ul class="simple">
<li><p>text and/or file, graph depending on options</p></li>
</ul>
</div></blockquote>
<p><strong>yaml format for x-y fit:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str data-set name&gt;</span>

<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str name x-data&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span>  <span class="nv">list of float</span> <span class="p p-Indicator">]</span>   

<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str name y-data&gt;</span>  
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">list of float</span> <span class="p p-Indicator">]</span>

<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt;, [list of floats], or {dictionary/ies}</span>
<span class="nt">y_errors</span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt;, [list of floats], or {dictionary/ies}</span>

<span class="nt">model_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;str model name&gt;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">&lt;Python code&gt;</span>

<span class="nt">format of uncertainty dictionary</span><span class="p">:</span> 
<span class="p p-Indicator">-</span> <span class="nt">error_value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;float&gt; or [list of floats]</span>
<span class="p p-Indicator">-</span> <span class="nt">correlation_coefficient</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0. or 1.</span>
<span class="p p-Indicator">-</span> <span class="nt">relative</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true or false</span>
<span class="l l-Scalar l-Scalar-Plain">relative errors may be spcified as &lt;float&gt;%</span>
</pre></div>
</div>
<p>Simple example of <em>yaml</em> input:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">label</span><span class="p">:</span> <span class="s">&#39;Test</span><span class="nv"> </span><span class="s">Data&#39;</span>

<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">0.36</span><span class="p p-Indicator">,</span><span class="nv">0.68</span><span class="p p-Indicator">,</span><span class="nv">0.80</span><span class="p p-Indicator">,</span><span class="nv">1.09</span><span class="p p-Indicator">,</span><span class="nv">1.46</span><span class="p p-Indicator">,</span><span class="nv">1.71</span><span class="p p-Indicator">,</span><span class="nv">1.83</span><span class="p p-Indicator">,</span><span class="nv">2.44</span><span class="p p-Indicator">,</span><span class="nv">2.09</span><span class="p p-Indicator">,</span><span class="nv">3.72</span><span class="p p-Indicator">,</span><span class="nv">4.36</span><span class="p p-Indicator">,</span><span class="nv">4.60</span><span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3%</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="s">&#39;x</span><span class="nv"> </span><span class="s">values&#39;</span>

<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.35</span><span class="p p-Indicator">,</span><span class="nv">0.26</span><span class="p p-Indicator">,</span><span class="nv">0.52</span><span class="p p-Indicator">,</span><span class="nv">0.44</span><span class="p p-Indicator">,</span><span class="nv">0.48</span><span class="p p-Indicator">,</span><span class="nv">0.55</span><span class="p p-Indicator">,</span><span class="nv">0.66</span><span class="p p-Indicator">,</span><span class="nv">0.48</span><span class="p p-Indicator">,</span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nv">0.70</span><span class="p p-Indicator">,</span><span class="nv">0.75</span><span class="p p-Indicator">,</span><span class="nv">0.80</span><span class="p p-Indicator">,</span><span class="nv">0.90</span><span class="p p-Indicator">]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">.06</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">.05</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.07</span><span class="p p-Indicator">,</span><span class="nv">.09</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">,</span><span class="nv">.11</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">,</span><span class="nv">.11</span><span class="p p-Indicator">,</span><span class="nv">.12</span><span class="p p-Indicator">,</span><span class="nv">.1</span><span class="p p-Indicator">]</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="s">&#39;y</span><span class="nv"> </span><span class="s">values&#39;</span>

<span class="nt">model_label</span><span class="p">:</span> <span class="s">&#39;Parabolic</span><span class="nv"> </span><span class="s">Fit&#39;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">def quadratic_model(x, a=0., b=1., c=0. ):</span>
    <span class="no">return a * x*x + b*x + c</span>
</pre></div>
</div>
<p><strong>Example of yaml input for histogram fit:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of a fit to histogram data</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">histogram</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example data</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="s">&#39;h&#39;</span> 
<span class="nt">y_label</span><span class="p">:</span> <span class="s">&#39;pdf(h)&#39;</span>

<span class="c1"># data:</span>
<span class="nt">raw_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">79.83</span><span class="p p-Indicator">,</span><span class="nv">79.63</span><span class="p p-Indicator">,</span><span class="nv">79.68</span><span class="p p-Indicator">,</span><span class="nv">79.82</span><span class="p p-Indicator">,</span><span class="nv">80.81</span><span class="p p-Indicator">,</span><span class="nv">79.97</span><span class="p p-Indicator">,</span><span class="nv">79.68</span><span class="p p-Indicator">,</span><span class="nv">80.32</span><span class="p p-Indicator">,</span><span class="nv">79.69</span><span class="p p-Indicator">,</span><span class="nv">79.18</span><span class="p p-Indicator">,</span>
        <span class="nv">80.04</span><span class="p p-Indicator">,</span><span class="nv">79.80</span><span class="p p-Indicator">,</span><span class="nv">79.98</span><span class="p p-Indicator">,</span><span class="nv">80.15</span><span class="p p-Indicator">,</span><span class="nv">79.77</span><span class="p p-Indicator">,</span><span class="nv">80.30</span><span class="p p-Indicator">,</span><span class="nv">80.18</span><span class="p p-Indicator">,</span><span class="nv">80.25</span><span class="p p-Indicator">,</span><span class="nv">79.88</span><span class="p p-Indicator">,</span><span class="nv">80.02</span> <span class="p p-Indicator">]</span>

<span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="nt">bin_range</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">79.</span><span class="p p-Indicator">,</span> <span class="nv">81.</span><span class="p p-Indicator">]</span>
<span class="c1"># alternatively an array for the bin edges can be specified</span>
<span class="c1">#bin_edges: [79., 79.5, 80, 80.5, 81.]</span>

<span class="nt">model_density_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">def normal_distribution(x, mu=80., sigma=1.):</span>
    <span class="no">return np.exp(-0.5*((x - mu)/sigma)** 2)/np.sqrt(2.*np.pi*sigma** 2)</span>
</pre></div>
</div>
<p><em>Remark</em>: more than one input data sets are also possible. 
Data sets and models can be overlayed in one plot if option 
<cite>showplots = False</cite> ist specified.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># several input sets to be separated by </span>
<span class="nn">...</span>
<span class="nn">---</span>   
</pre></div>
</div>
<span class="target" id="module-plotData"></span><p><strong>plotData.py</strong> [options] &lt;input file name&gt;</p>
<p>Plot (several) data set(s) with error bars in x- and y- directions 
or histograms from file in yaml format</p>
<p>usage:</p>
<blockquote>
<div><p>./plotData.py [options] &lt;input file name&gt;</p>
</div></blockquote>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li><p>input file in yaml format</p></li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li><p>figure</p></li>
</ul>
</div></blockquote>
<p>yaml-format for (x-y) data:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">x_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">x values</span> <span class="p p-Indicator">]</span>
<span class="nt">y_data</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">y values</span> <span class="p p-Indicator">]</span>
<span class="nt">x_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-uncertainty or [x-uncertainties]</span>
<span class="nt">y_errors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">y-uncertainty or [y-uncertainties]</span>

<span class="l l-Scalar l-Scalar-Plain">several input sets to be separated by</span> 
<span class="nn">...</span>
<span class="nn">---</span>   
</pre></div>
</div>
<p>yaml-format for histogram:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;title of plot&gt;</span>
<span class="nt">x_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for x-axis&gt;</span>
<span class="nt">y_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;label for y-axis&gt;</span>

<span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;name of data set&gt;</span>
<span class="nt">raw_data</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x1</span><span class="p p-Indicator">,</span> <span class="nv">...</span> <span class="p p-Indicator">,</span> <span class="nv">xn</span><span class="p p-Indicator">]</span>
<span class="c1"># define binning</span>
<span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">n</span>
<span class="nt">bin_range</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">x_min</span><span class="p p-Indicator">,</span> <span class="nv">x_max</span><span class="p p-Indicator">]</span>
<span class="c1">#   alternatively: </span>
<span class="c1"># bin edges: [e0, ..., en]</span>

<span class="l l-Scalar l-Scalar-Plain">several input sets to be separated by</span> 
<span class="nn">...</span>
<span class="nn">---</span>   
</pre></div>
</div>
<p>In case a model function is also supplied, it is overlayed in the 
output graph. The corresponding <em>yaml</em> block looks as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># optional model specification</span>
<span class="nt">model_label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;model name&gt;</span>
<span class="nt">model_function</span><span class="p">:</span> <span class="p p-Indicator">|</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;Python code of model function&gt;</span>
</pre></div>
</div>
<p>If no <cite>y_data</cite> or <cite>raw_data</cite> keys are provided, only the model function 
is shown. Note that minimalistic <cite>x_data</cite> and <cite>bin_range</cite> or <cite>bin_edges</cite>
information must be given to define the x-range of the graph.</p>
<span class="target" id="module-csv2yml"></span><dl>
<dt>csv2yml.py </dt><dd><p>read floating-point column-data in very general .txt  formats 
and write an output block in yaml format</p>
<p>keys taken from 1st header line</p>
<p>Usage:</p>
<blockquote>
<div><p>./cvs2yml [options] &lt;input file name&gt;</p>
</div></blockquote>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li><p>file name</p></li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li><p>yaml data block</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><strong>PhyPraKit Documentation</strong></a><ul>
<li><a class="reference internal" href="#about">About</a><ul>
<li><a class="reference internal" href="#installation">Installation:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualization-and-analysis-of-measurement-data"><strong>Visualization and Analysis of Measurement Data</strong></a></li>
<li><a class="reference internal" href="#dokumentation-der-module-und-beispiele">Dokumentation der Module und Beispiele</a></li>
<li><a class="reference internal" href="#module-PhyPraKit">Module Documentation</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">PhyPraKit 1.2.3b1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><strong>PhyPraKit Documentation</strong></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Günter Quast.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>